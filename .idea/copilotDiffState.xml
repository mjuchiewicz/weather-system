<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="CopilotDiffPersistence">
    <option name="pendingDiffs">
      <map>
        <entry key="$PROJECT_DIR$/weather-provider/src/main/java/com/weather/provider/WeatherGrpcService.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/weather-provider/src/main/java/com/weather/provider/WeatherGrpcService.java" />
              <option name="originalContent" value="package com.weather.provider;&#10;&#10;import com.weather.provider.api.OpenWeatherMapService;&#10;import com.weather.provider.grpc.WeatherRequest;&#10;import com.weather.provider.grpc.WeatherResponse;&#10;import com.weather.provider.grpc.WeatherServiceGrpc;&#10;import com.weather.provider.model.WeatherAlert;&#10;import com.weather.provider.model.WeatherHistory;&#10;import com.weather.provider.repository.WeatherHistoryRepository;&#10;import com.weather.provider.service.WeatherAlertService;&#10;import io.grpc.stub.StreamObserver;&#10;import org.springframework.amqp.rabbit.core.RabbitTemplate;&#10;import org.springframework.beans.factory.annotation.Autowired;&#10;import org.springframework.beans.factory.annotation.Value;&#10;import org.springframework.stereotype.Service;&#10;&#10;import java.util.List;&#10;&#10;@Service&#10;public class WeatherGrpcService extends WeatherServiceGrpc.WeatherServiceImplBase {&#10;&#10;    @Autowired&#10;    private RabbitTemplate rabbitTemplate;&#10;&#10;    @Value(&quot;${weather.alert.queue}&quot;)&#10;    private String queueName;&#10;&#10;    @Autowired&#10;    private WeatherAlertService alertService;&#10;&#10;    @Autowired&#10;    private WeatherHistoryRepository historyRepository;&#10;&#10;    @Autowired&#10;    private OpenWeatherMapService weatherApiService;&#10;&#10;    @Override&#10;    public void getWeather(WeatherRequest request, StreamObserver&lt;WeatherResponse&gt; responseObserver) {&#10;        System.out.println(&quot;Received weather request for city: &quot; + request.getCity());&#10;&#10;        // CALL REAL WEATHER API&#10;        OpenWeatherMapService.WeatherData apiData = weatherApiService.getWeather(request.getCity());&#10;&#10;        double temperature = apiData.getTemperature();&#10;        String description = apiData.getDescription();&#10;        String status = &quot;OK&quot;;&#10;&#10;        // AUTO-SAVE do historii&#10;        try {&#10;            WeatherHistory history = new WeatherHistory(&#10;                    request.getCity(),&#10;                    temperature,&#10;                    description,&#10;                    apiData.getHumidity()&#10;            );&#10;            historyRepository.save(history);&#10;            System.out.println(&quot;Saved to history: &quot; + request.getCity() + &quot;, &quot; + temperature + &quot;°C&quot;);&#10;        } catch (Exception e) {&#10;            System.err.println(&quot;Failed to save history: &quot; + e.getMessage());&#10;        }&#10;&#10;        // SPRAWDŹ ALERTY Z BAZY DANYCH&#10;        try {&#10;            List&lt;WeatherAlert&gt; activeAlerts = alertService.getActive();&#10;&#10;            for (WeatherAlert alert : activeAlerts) {&#10;                if (&quot;TEMPERATURE&quot;.equals(alert.getAlertType())) {&#10;                    boolean triggered = checkThreshold(temperature, alert.getOperator(), alert.getThreshold());&#10;&#10;                    if (triggered) {&#10;                        status = &quot;ALERT&quot;;&#10;&#10;                        String alertMessage = String.format(&#10;                                &quot; %s | %s: %.1f°C (threshold: %.1f°C) - %s&quot;,&#10;                                alert.getSeverity(),&#10;                                request.getCity(),&#10;                                temperature,&#10;                                alert.getThreshold(),&#10;                                alert.getMessage()&#10;                        );&#10;&#10;                        rabbitTemplate.convertAndSend(queueName, alertMessage);&#10;                        System.out.println(&quot;Alert triggered and sent to RabbitMQ: &quot; + alertMessage);&#10;&#10;                        break;&#10;                    }&#10;                }&#10;            }&#10;        } catch (Exception e) {&#10;            System.err.println(&quot;Error checking alerts: &quot; + e.getMessage());&#10;        }&#10;&#10;        // odpowiedź gRPC&#10;        WeatherResponse response = WeatherResponse.newBuilder()&#10;                .setCity(request.getCity())&#10;                .setTemperature(temperature)&#10;                .setDescription(description)&#10;                .setStatus(status)&#10;                .build();&#10;&#10;        responseObserver.onNext(response);&#10;        responseObserver.onCompleted();&#10;&#10;        System.out.println(String.format(&quot;Sent weather response: %s, %.1f°C, %s (REAL DATA!)&quot;,&#10;                request.getCity(), temperature, status));&#10;    }&#10;&#10;    private boolean checkThreshold(double value, String operator, double threshold) {&#10;        switch (operator) {&#10;            case &quot;&gt;&quot;:&#10;                return value &gt; threshold;&#10;            case &quot;&lt;&quot;:&#10;                return value &lt; threshold;&#10;            case &quot;&gt;=&quot;:&#10;                return value &gt;= threshold;&#10;            case &quot;&lt;=&quot;:&#10;                return value &lt;= threshold;&#10;            default:&#10;                return value &gt; threshold;&#10;        }&#10;    }&#10;&#10;    // ============================================&#10;// ZAMIEŃ CAŁĄ METODĘ getWeatherStream w WeatherGrpcService.java&#10;// ============================================&#10;&#10;    @Override&#10;    public void getWeatherStream(com.weather.provider.grpc.WeatherStreamRequest request,&#10;                                 StreamObserver&lt;WeatherResponse&gt; responseObserver) {&#10;&#10;        String city = request.getCity();&#10;        int updates = request.getUpdates() &gt; 0 ? request.getUpdates() : 10;  // Default 10&#10;        int intervalSeconds = request.getIntervalSeconds() &gt; 0 ? request.getIntervalSeconds() : 5;  // Default 5s&#10;&#10;        System.out.println(&quot; Starting weather stream for &quot; + city);&#10;        System.out.println(&quot;   Updates: &quot; + updates + &quot;, Interval: &quot; + intervalSeconds + &quot;s&quot;);&#10;&#10;        try {&#10;            for (int i = 1; i &lt;= updates; i++) {&#10;                System.out.println(&quot;   Sending update #&quot; + i + &quot;...&quot;);&#10;&#10;                // Fetch REAL weather from OpenWeatherMap!&#10;                OpenWeatherMapService.WeatherData currentWeather = weatherApiService.getWeather(city);&#10;&#10;                // Build response&#10;                WeatherResponse response = WeatherResponse.newBuilder()&#10;                        .setCity(city)&#10;                        .setTemperature(currentWeather.getTemperature())&#10;                        .setDescription(currentWeather.getDescription())&#10;                        .setStatus(&quot;STREAMING&quot;)&#10;                        .setTimestamp(System.currentTimeMillis())&#10;                        .setUpdateNumber(i)&#10;                        .build();&#10;&#10;                // Send to client via stream!&#10;                responseObserver.onNext(response);&#10;&#10;                // Wait before next update (except for last one)&#10;                if (i &lt; updates) {&#10;                    Thread.sleep(intervalSeconds * 1000);&#10;                }&#10;            }&#10;&#10;            // Stream completed!&#10;            System.out.println(&quot;✅ Stream completed! Sent &quot; + updates + &quot; updates&quot;);&#10;            responseObserver.onCompleted();&#10;&#10;        } catch (InterruptedException e) {&#10;            System.err.println(&quot;❌ Stream interrupted: &quot; + e.getMessage());&#10;            responseObserver.onError(e);&#10;        } catch (Exception e) {&#10;            System.err.println(&quot;❌ Stream error: &quot; + e.getMessage());&#10;            e.printStackTrace();&#10;            responseObserver.onError(e);&#10;        }&#10;    }&#10;}" />
              <option name="updatedContent" value="package com.weather.provider;&#10;&#10;import com.weather.provider.api.OpenWeatherMapService;&#10;import com.weather.provider.grpc.WeatherRequest;&#10;import com.weather.provider.grpc.WeatherResponse;&#10;import com.weather.provider.grpc.WeatherServiceGrpc;&#10;import com.weather.provider.model.WeatherAlert;&#10;import com.weather.provider.model.WeatherHistory;&#10;import com.weather.provider.repository.WeatherHistoryRepository;&#10;import com.weather.provider.service.WeatherAlertService;&#10;import io.grpc.stub.StreamObserver;&#10;import org.springframework.amqp.rabbit.core.RabbitTemplate;&#10;import org.springframework.beans.factory.annotation.Autowired;&#10;import org.springframework.beans.factory.annotation.Value;&#10;import org.springframework.stereotype.Service;&#10;&#10;import java.util.List;&#10;&#10;@Service&#10;public class WeatherGrpcService extends WeatherServiceGrpc.WeatherServiceImplBase {&#10;&#10;    @Autowired&#10;    private RabbitTemplate rabbitTemplate;&#10;&#10;    @Value(&quot;${weather.alert.queue}&quot;)&#10;    private String queueName;&#10;&#10;    @Autowired&#10;    private WeatherAlertService alertService;&#10;&#10;    @Autowired&#10;    private WeatherHistoryRepository historyRepository;&#10;&#10;    @Autowired&#10;    private OpenWeatherMapService weatherApiService;&#10;&#10;    @Override&#10;    public void getWeather(WeatherRequest request, StreamObserver&lt;WeatherResponse&gt; responseObserver) {&#10;        System.out.println(&quot;Received weather request for city: &quot; + request.getCity());&#10;&#10;        // CALL REAL WEATHER API&#10;        OpenWeatherMapService.WeatherData apiData = weatherApiService.getWeather(request.getCity());&#10;&#10;        double temperature = apiData.getTemperature();&#10;        String description = apiData.getDescription();&#10;        String status = &quot;OK&quot;;&#10;&#10;        // AUTO-SAVE do historii&#10;        try {&#10;            WeatherHistory history = new WeatherHistory(&#10;                    request.getCity(),&#10;                    temperature,&#10;                    description,&#10;                    apiData.getHumidity()&#10;            );&#10;            historyRepository.save(history);&#10;            System.out.println(&quot;Saved to history: &quot; + request.getCity() + &quot;, &quot; + temperature + &quot;°C&quot;);&#10;        } catch (Exception e) {&#10;            System.err.println(&quot;Failed to save history: &quot; + e.getMessage());&#10;        }&#10;&#10;        // SPRAWDŹ ALERTY Z BAZY DANYCH&#10;        try {&#10;            List&lt;WeatherAlert&gt; activeAlerts = alertService.getActive();&#10;&#10;            for (WeatherAlert alert : activeAlerts) {&#10;                if (&quot;TEMPERATURE&quot;.equals(alert.getAlertType())) {&#10;                    boolean triggered = checkThreshold(temperature, alert.getOperator(), alert.getThreshold());&#10;&#10;                    if (triggered) {&#10;                        status = &quot;ALERT&quot;;&#10;&#10;                        String alertMessage = String.format(&#10;                                &quot; %s | %s: %.1f°C (threshold: %.1f°C) - %s&quot;,&#10;                                alert.getSeverity(),&#10;                                request.getCity(),&#10;                                temperature,&#10;                                alert.getThreshold(),&#10;                                alert.getMessage()&#10;                        );&#10;&#10;                        rabbitTemplate.convertAndSend(queueName, alertMessage);&#10;                        System.out.println(&quot;Alert triggered and sent to RabbitMQ: &quot; + alertMessage);&#10;&#10;                        break;&#10;                    }&#10;                }&#10;            }&#10;        } catch (Exception e) {&#10;            System.err.println(&quot;Error checking alerts: &quot; + e.getMessage());&#10;        }&#10;&#10;        // odpowiedź gRPC&#10;        WeatherResponse response = WeatherResponse.newBuilder()&#10;                .setCity(request.getCity())&#10;                .setTemperature(temperature)&#10;                .setDescription(description)&#10;                .setStatus(status)&#10;                .build();&#10;&#10;        responseObserver.onNext(response);&#10;        responseObserver.onCompleted();&#10;&#10;        System.out.println(String.format(&quot;Sent weather response: %s, %.1f°C, %s (REAL DATA!)&quot;,&#10;                request.getCity(), temperature, status));&#10;    }&#10;&#10;    private boolean checkThreshold(double value, String operator, double threshold) {&#10;        switch (operator) {&#10;            case &quot;&gt;&quot;:&#10;                return value &gt; threshold;&#10;            case &quot;&lt;&quot;:&#10;                return value &lt; threshold;&#10;            case &quot;&gt;=&quot;:&#10;                return value &gt;= threshold;&#10;            case &quot;&lt;=&quot;:&#10;                return value &lt;= threshold;&#10;            default:&#10;                return value &gt; threshold;&#10;        }&#10;    }&#10;&#10;    // ============================================&#10;// ZAMIEŃ CAŁĄ METODĘ getWeatherStream w WeatherGrpcService.java&#10;// ============================================&#10;&#10;    @Override&#10;    public void getWeatherStream(com.weather.provider.grpc.WeatherStreamRequest request,&#10;                                 StreamObserver&lt;WeatherResponse&gt; responseObserver) {&#10;&#10;        String city = request.getCity();&#10;        int updates = request.getUpdates() &gt; 0 ? request.getUpdates() : 10;  // Default 10&#10;        int intervalSeconds = request.getIntervalSeconds() &gt; 0 ? request.getIntervalSeconds() : 5;  // Default 5s&#10;&#10;        System.out.println(&quot; Starting weather stream for &quot; + city);&#10;        System.out.println(&quot;   Updates: &quot; + updates + &quot;, Interval: &quot; + intervalSeconds + &quot;s&quot;);&#10;&#10;        try {&#10;            for (int i = 1; i &lt;= updates; i++) {&#10;                System.out.println(&quot;   Sending update #&quot; + i + &quot;...&quot;);&#10;&#10;                // Fetch REAL weather from OpenWeatherMap!&#10;                OpenWeatherMapService.WeatherData currentWeather = weatherApiService.getWeather(city);&#10;&#10;                // AUTO-SAVE to history database (same as getWeather method)&#10;                try {&#10;                    WeatherHistory history = new WeatherHistory(&#10;                            city,&#10;                            currentWeather.getTemperature(),&#10;                            currentWeather.getDescription(),&#10;                            currentWeather.getHumidity()&#10;                    );&#10;                    historyRepository.save(history);&#10;                    System.out.println(&quot;    Saved to history: &quot; + city + &quot;, &quot; + currentWeather.getTemperature() + &quot;°C&quot;);&#10;                } catch (Exception e) {&#10;                    System.err.println(&quot;   ⚠️ Failed to save history: &quot; + e.getMessage());&#10;                }&#10;&#10;                // Build response&#10;                WeatherResponse response = WeatherResponse.newBuilder()&#10;                        .setCity(city)&#10;                        .setTemperature(currentWeather.getTemperature())&#10;                        .setDescription(currentWeather.getDescription())&#10;                        .setStatus(&quot;STREAMING&quot;)&#10;                        .setTimestamp(System.currentTimeMillis())&#10;                        .setUpdateNumber(i)&#10;                        .build();&#10;&#10;                // Send to client via stream!&#10;                responseObserver.onNext(response);&#10;&#10;                // Wait before next update (except for last one)&#10;                if (i &lt; updates) {&#10;                    Thread.sleep(intervalSeconds * 1000);&#10;                }&#10;            }&#10;&#10;            // Stream completed!&#10;            System.out.println(&quot;✅ Stream completed! Sent &quot; + updates + &quot; updates&quot;);&#10;            responseObserver.onCompleted();&#10;&#10;        } catch (InterruptedException e) {&#10;            System.err.println(&quot;❌ Stream interrupted: &quot; + e.getMessage());&#10;            responseObserver.onError(e);&#10;        } catch (Exception e) {&#10;            System.err.println(&quot;❌ Stream error: &quot; + e.getMessage());&#10;            e.printStackTrace();&#10;            responseObserver.onError(e);&#10;        }&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/web-client/index.html">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/web-client/index.html" />
              <option name="originalContent" value="&lt;!DOCTYPE html&gt;&#10;&lt;html lang=&quot;en&quot;&gt;&#10;&lt;head&gt;&#10;    &lt;meta charset=&quot;UTF-8&quot;&gt;&#10;    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;&#10;    &lt;title&gt;Weather System&lt;/title&gt;&#10;    &lt;style&gt;&#10;        * {&#10;            margin: 0;&#10;            padding: 0;&#10;            box-sizing: border-box;&#10;        }&#10;&#10;        body {&#10;            font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', 'Segoe UI', sans-serif;&#10;            background: linear-gradient(135deg, #e0f2fe 0%, #fef3c7 100%);&#10;            min-height: 100vh;&#10;            padding: 60px 20px;&#10;            color: #1e293b;&#10;        }&#10;&#10;        .container {&#10;            max-width: 1200px;&#10;            margin: 0 auto;&#10;        }&#10;&#10;        .header {&#10;            text-align: center;&#10;            margin-bottom: 60px;&#10;        }&#10;&#10;        .header h1 {&#10;            font-size: 52px;&#10;            font-weight: 700;&#10;            margin-bottom: 12px;&#10;            color: #0f172a;&#10;            letter-spacing: -1px;&#10;            text-shadow: 0 2px 4px rgba(0,0,0,0.05);&#10;        }&#10;&#10;        .header .subtitle {&#10;            font-size: 18px;&#10;            color: #64748b;&#10;            font-weight: 400;&#10;        }&#10;&#10;        .section {&#10;            background: rgba(255, 255, 255, 0.95);&#10;            backdrop-filter: blur(10px);&#10;            border-radius: 16px;&#10;            padding: 40px;&#10;            margin-bottom: 24px;&#10;            box-shadow: 0 4px 20px rgba(0,0,0,0.08);&#10;            border: 1px solid rgba(255,255,255,0.8);&#10;        }&#10;&#10;        .section-title {&#10;            font-size: 24px;&#10;            font-weight: 700;&#10;            margin-bottom: 28px;&#10;            color: #0f172a;&#10;            display: flex;&#10;            align-items: center;&#10;            gap: 10px;&#10;        }&#10;&#10;        .form-group {&#10;            margin-bottom: 20px;&#10;        }&#10;&#10;        label {&#10;            display: block;&#10;            font-size: 14px;&#10;            font-weight: 600;&#10;            margin-bottom: 8px;&#10;            color: #475569;&#10;        }&#10;&#10;        input, select {&#10;            width: 100%;&#10;            padding: 14px 16px;&#10;            font-size: 16px;&#10;            border: 2px solid #e2e8f0;&#10;            border-radius: 10px;&#10;            outline: none;&#10;            transition: all 0.2s;&#10;            background: white;&#10;        }&#10;&#10;        input:focus, select:focus {&#10;            border-color: #3b82f6;&#10;            box-shadow: 0 0 0 4px rgba(59, 130, 246, 0.1);&#10;        }&#10;&#10;        .form-row {&#10;            display: grid;&#10;            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));&#10;            gap: 16px;&#10;        }&#10;&#10;        button {&#10;            padding: 14px 28px;&#10;            font-size: 16px;&#10;            font-weight: 600;&#10;            border: none;&#10;            border-radius: 10px;&#10;            cursor: pointer;&#10;            transition: all 0.25s;&#10;        }&#10;&#10;        .btn-primary {&#10;            background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);&#10;            color: white;&#10;        }&#10;&#10;        .btn-primary:hover {&#10;            transform: translateY(-2px);&#10;            box-shadow: 0 8px 20px rgba(59, 130, 246, 0.4);&#10;        }&#10;&#10;        .btn-success {&#10;            background: linear-gradient(135deg, #10b981 0%, #059669 100%);&#10;            color: white;&#10;        }&#10;&#10;        .btn-success:hover {&#10;            transform: translateY(-2px);&#10;            box-shadow: 0 8px 20px rgba(16, 185, 129, 0.4);&#10;        }&#10;&#10;        .btn-edit {&#10;            background: #f1f5f9;&#10;            color: #475569;&#10;            padding: 10px 18px;&#10;            font-size: 14px;&#10;            margin-right: 6px;&#10;        }&#10;&#10;        .btn-edit:hover {&#10;            background: #e2e8f0;&#10;        }&#10;&#10;        .btn-warning {&#10;            background: #fbbf24;&#10;            color: white;&#10;            padding: 10px 18px;&#10;            font-size: 14px;&#10;        }&#10;&#10;        .btn-warning:hover {&#10;            background: #f59e0b;&#10;        }&#10;&#10;        .btn-danger {&#10;            background: #ef4444;&#10;            color: white;&#10;            padding: 10px 18px;&#10;            font-size: 14px;&#10;        }&#10;&#10;        .btn-danger:hover {&#10;            background: #dc2626;&#10;        }&#10;&#10;        table {&#10;            width: 100%;&#10;            border-collapse: collapse;&#10;            margin-top: 28px;&#10;        }&#10;&#10;        th {&#10;            text-align: left;&#10;            padding: 14px;&#10;            background: #f8fafc;&#10;            font-weight: 700;&#10;            font-size: 13px;&#10;            color: #64748b;&#10;            border-bottom: 2px solid #e2e8f0;&#10;        }&#10;&#10;        td {&#10;            padding: 16px 14px;&#10;            border-bottom: 1px solid #f1f5f9;&#10;            font-size: 15px;&#10;        }&#10;&#10;        tr:hover {&#10;            background: #fafafa;&#10;        }&#10;&#10;        .alert-badge {&#10;            display: inline-block;&#10;            padding: 6px 14px;&#10;            border-radius: 8px;&#10;            font-size: 12px;&#10;            font-weight: 700;&#10;            color: white;&#10;        }&#10;&#10;        .color-preview {&#10;            display: inline-block;&#10;            width: 28px;&#10;            height: 28px;&#10;            border-radius: 6px;&#10;            border: 2px solid #e2e8f0;&#10;            vertical-align: middle;&#10;        }&#10;&#10;        /* BEAUTIFUL WEATHER CARD */&#10;        .weather-card {&#10;            background: linear-gradient(135deg, #60a5fa 0%, #3b82f6 100%);&#10;            padding: 56px 40px;&#10;            border-radius: 16px;&#10;            text-align: center;&#10;            margin-top: 28px;&#10;            box-shadow: 0 10px 30px rgba(59, 130, 246, 0.3);&#10;            color: white;&#10;        }&#10;&#10;        .weather-city {&#10;            font-size: 24px;&#10;            font-weight: 600;&#10;            margin-bottom: 16px;&#10;            opacity: 0.95;&#10;        }&#10;&#10;        .weather-temp {&#10;            font-size: 76px;&#10;            font-weight: 200;&#10;            margin-bottom: 12px;&#10;            letter-spacing: -3px;&#10;        }&#10;&#10;        .weather-desc {&#10;            font-size: 20px;&#10;            margin-bottom: 24px;&#10;            opacity: 0.95;&#10;        }&#10;&#10;        .weather-status {&#10;            display: inline-block;&#10;            padding: 10px 24px;&#10;            background: rgba(255,255,255,0.25);&#10;            backdrop-filter: blur(10px);&#10;            border-radius: 12px;&#10;            font-size: 14px;&#10;            font-weight: 700;&#10;        }&#10;&#10;        /* ALERT MESSAGE BOX */&#10;        .alert-message-box {&#10;            margin-top: 28px;&#10;            padding: 24px;&#10;            border-radius: 12px;&#10;            display: flex;&#10;            align-items: center;&#10;            gap: 20px;&#10;            background: rgba(255,255,255,0.2);&#10;            backdrop-filter: blur(10px);&#10;            border: 1px solid rgba(255,255,255,0.3);&#10;        }&#10;&#10;        .alert-icon {&#10;            font-size: 32px;&#10;        }&#10;&#10;        .alert-content {&#10;            flex: 1;&#10;            text-align: left;&#10;        }&#10;&#10;        .alert-title {&#10;            font-size: 18px;&#10;            font-weight: 700;&#10;            margin-bottom: 6px;&#10;        }&#10;&#10;        .alert-text {&#10;            font-size: 16px;&#10;            opacity: 0.95;&#10;        }&#10;&#10;        .report-grid {&#10;            display: grid;&#10;            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));&#10;            gap: 20px;&#10;            margin-top: 28px;&#10;        }&#10;&#10;        .report-item {&#10;            background: #f8fafc;&#10;            padding: 32px 24px;&#10;            border-radius: 12px;&#10;            text-align: center;&#10;            border: 1px solid #e2e8f0;&#10;        }&#10;&#10;        .report-item .label {&#10;            font-size: 13px;&#10;            color: #64748b;&#10;            margin-bottom: 12px;&#10;            font-weight: 600;&#10;        }&#10;&#10;        .report-item .value {&#10;            font-size: 32px;&#10;            font-weight: 700;&#10;            color: #0f172a;&#10;        }&#10;&#10;        .empty-state {&#10;            text-align: center;&#10;            padding: 60px 20px;&#10;            color: #94a3b8;&#10;            font-size: 16px;&#10;        }&#10;&#10;        .toast {&#10;            position: fixed;&#10;            top: 24px;&#10;            right: 24px;&#10;            background: #0f172a;&#10;            color: white;&#10;            padding: 16px 24px;&#10;            border-radius: 12px;&#10;            box-shadow: 0 10px 40px rgba(0,0,0,0.3);&#10;            display: none;&#10;            animation: slideIn 0.3s ease;&#10;            z-index: 1000;&#10;            font-weight: 600;&#10;        }&#10;&#10;        .toast.error {&#10;            background: #ef4444;&#10;        }&#10;&#10;        @keyframes slideIn {&#10;            from {&#10;                transform: translateX(100%);&#10;                opacity: 0;&#10;            }&#10;            to {&#10;                transform: translateX(0);&#10;                opacity: 1;&#10;            }&#10;        }&#10;&#10;        @keyframes pulse {&#10;            0%, 100% {&#10;                opacity: 1;&#10;            }&#10;            50% {&#10;                opacity: 0.5;&#10;            }&#10;        }&#10;&#10;        .loading {&#10;            display: none;&#10;            text-align: center;&#10;            padding: 28px;&#10;            color: #3b82f6;&#10;            font-weight: 600;&#10;            font-size: 16px;&#10;        }&#10;&#10;        .hidden {&#10;            display: none;&#10;        }&#10;&#10;        /* Modal */&#10;        .modal {&#10;            display: none;&#10;            position: fixed;&#10;            top: 0;&#10;            left: 0;&#10;            width: 100%;&#10;            height: 100%;&#10;            background: rgba(15, 23, 42, 0.6);&#10;            backdrop-filter: blur(8px);&#10;            z-index: 1000;&#10;            align-items: center;&#10;            justify-content: center;&#10;        }&#10;&#10;        .modal.show {&#10;            display: flex;&#10;        }&#10;&#10;        .modal-content {&#10;            background: white;&#10;            border-radius: 16px;&#10;            padding: 40px;&#10;            max-width: 540px;&#10;            width: 90%;&#10;            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);&#10;        }&#10;&#10;        .modal-title {&#10;            font-size: 26px;&#10;            font-weight: 700;&#10;            margin-bottom: 28px;&#10;            color: #0f172a;&#10;        }&#10;&#10;        .modal-actions {&#10;            display: flex;&#10;            gap: 12px;&#10;            margin-top: 28px;&#10;            justify-content: flex-end;&#10;        }&#10;&#10;        .btn-cancel {&#10;            background: #f1f5f9;&#10;            color: #475569;&#10;            padding: 14px 28px;&#10;            font-size: 16px;&#10;            font-weight: 600;&#10;            border: none;&#10;            border-radius: 10px;&#10;            cursor: pointer;&#10;        }&#10;&#10;        .btn-cancel:hover {&#10;            background: #e2e8f0;&#10;        }&#10;&#10;        /* Compact Section */&#10;        .compact-section {&#10;            padding: 28px 40px;&#10;        }&#10;&#10;        .compact-section .section-title {&#10;            font-size: 20px;&#10;            margin-bottom: 16px;&#10;        }&#10;&#10;        .compact-section p {&#10;            font-size: 14px;&#10;            color: #64748b;&#10;            margin-bottom: 16px;&#10;            line-height: 1.6;&#10;        }&#10;    &lt;/style&gt;&#10;&lt;/head&gt;&#10;&lt;body&gt;&#10;&#10;&lt;div class=&quot;toast&quot; id=&quot;toast&quot;&gt;&lt;/div&gt;&#10;&#10;&lt;!-- Edit Modal --&gt;&#10;&lt;div class=&quot;modal&quot; id=&quot;editModal&quot;&gt;&#10;    &lt;div class=&quot;modal-content&quot;&gt;&#10;        &lt;div class=&quot;modal-title&quot;&gt;Edit Alert Rule&lt;/div&gt;&#10;        &lt;form id=&quot;editForm&quot; onsubmit=&quot;saveEdit(event)&quot;&gt;&#10;            &lt;input type=&quot;hidden&quot; id=&quot;editId&quot;&gt;&#10;            &lt;div class=&quot;form-row&quot;&gt;&#10;                &lt;div class=&quot;form-group&quot;&gt;&#10;                    &lt;label&gt;Alert Type&lt;/label&gt;&#10;                    &lt;select id=&quot;editAlertType&quot; required&gt;&#10;                        &lt;option value=&quot;TEMPERATURE&quot;&gt;Temperature&lt;/option&gt;&#10;                        &lt;option value=&quot;HUMIDITY&quot;&gt;Humidity&lt;/option&gt;&#10;                        &lt;option value=&quot;WIND&quot;&gt;Wind Speed&lt;/option&gt;&#10;                    &lt;/select&gt;&#10;                &lt;/div&gt;&#10;                &lt;div class=&quot;form-group&quot;&gt;&#10;                    &lt;label&gt;Condition&lt;/label&gt;&#10;                    &lt;div style=&quot;display: flex; gap: 8px;&quot;&gt;&#10;                        &lt;select id=&quot;editOperator&quot; required style=&quot;width: 80px;&quot;&gt;&#10;                            &lt;option value=&quot;&gt;&quot;&gt;&gt;&lt;/option&gt;&#10;                            &lt;option value=&quot;&lt;&quot;&gt;&lt;&lt;/option&gt;&#10;                            &lt;option value=&quot;&gt;=&quot;&gt;&gt;=&lt;/option&gt;&#10;                            &lt;option value=&quot;&lt;=&quot;&gt;&lt;=&lt;/option&gt;&#10;                        &lt;/select&gt;&#10;                        &lt;input type=&quot;number&quot; step=&quot;0.1&quot; id=&quot;editThreshold&quot; required style=&quot;flex: 1;&quot;&gt;&#10;                    &lt;/div&gt;&#10;                &lt;/div&gt;&#10;            &lt;/div&gt;&#10;            &lt;div class=&quot;form-row&quot;&gt;&#10;                &lt;div class=&quot;form-group&quot;&gt;&#10;                    &lt;label&gt;Severity&lt;/label&gt;&#10;                    &lt;select id=&quot;editSeverity&quot; required&gt;&#10;                        &lt;option value=&quot;LOW&quot;&gt;Low&lt;/option&gt;&#10;                        &lt;option value=&quot;MEDIUM&quot;&gt;Medium&lt;/option&gt;&#10;                        &lt;option value=&quot;HIGH&quot;&gt;High&lt;/option&gt;&#10;                        &lt;option value=&quot;EXTREME&quot;&gt;Extreme&lt;/option&gt;&#10;                    &lt;/select&gt;&#10;                &lt;/div&gt;&#10;                &lt;div class=&quot;form-group&quot;&gt;&#10;                    &lt;label&gt;Color&lt;/label&gt;&#10;                    &lt;input type=&quot;color&quot; id=&quot;editColor&quot; required&gt;&#10;                &lt;/div&gt;&#10;            &lt;/div&gt;&#10;            &lt;div class=&quot;form-group&quot;&gt;&#10;                &lt;label&gt;Alert Message&lt;/label&gt;&#10;                &lt;input type=&quot;text&quot; id=&quot;editMessage&quot; required&gt;&#10;            &lt;/div&gt;&#10;            &lt;div class=&quot;modal-actions&quot;&gt;&#10;                &lt;button type=&quot;button&quot; class=&quot;btn-cancel&quot; onclick=&quot;closeEditModal()&quot;&gt;Cancel&lt;/button&gt;&#10;                &lt;button type=&quot;submit&quot; class=&quot;btn-primary&quot;&gt;Save Changes&lt;/button&gt;&#10;            &lt;/div&gt;&#10;        &lt;/form&gt;&#10;    &lt;/div&gt;&#10;&lt;/div&gt;&#10;&#10;&lt;div class=&quot;container&quot;&gt;&#10;    &lt;div class=&quot;header&quot;&gt;&#10;        &lt;h1&gt;⛅ Weather System&lt;/h1&gt;&#10;        &lt;p class=&quot;subtitle&quot;&gt;Distributed Microservices Architecture&lt;/p&gt;&#10;    &lt;/div&gt;&#10;&#10;    &lt;!-- Alert Rules Manager --&gt;&#10;    &lt;div class=&quot;section&quot;&gt;&#10;        &lt;div class=&quot;section-title&quot;&gt;⚡ Alert Rules Manager&lt;/div&gt;&#10;        &lt;form id=&quot;alertForm&quot; onsubmit=&quot;addAlert(event)&quot;&gt;&#10;            &lt;div class=&quot;form-row&quot;&gt;&#10;                &lt;div class=&quot;form-group&quot;&gt;&#10;                    &lt;label&gt;Alert Type&lt;/label&gt;&#10;                    &lt;select id=&quot;alertType&quot; required&gt;&#10;                        &lt;option value=&quot;TEMPERATURE&quot;&gt;Temperature&lt;/option&gt;&#10;                        &lt;option value=&quot;HUMIDITY&quot;&gt;Humidity&lt;/option&gt;&#10;                        &lt;option value=&quot;WIND&quot;&gt;Wind Speed&lt;/option&gt;&#10;                    &lt;/select&gt;&#10;                &lt;/div&gt;&#10;                &lt;div class=&quot;form-group&quot;&gt;&#10;                    &lt;label&gt;Condition&lt;/label&gt;&#10;                    &lt;div style=&quot;display: flex; gap: 8px;&quot;&gt;&#10;                        &lt;select id=&quot;operator&quot; required style=&quot;width: 80px;&quot;&gt;&#10;                            &lt;option value=&quot;&gt;&quot;&gt;&gt;&lt;/option&gt;&#10;                            &lt;option value=&quot;&lt;&quot;&gt;&lt;&lt;/option&gt;&#10;                            &lt;option value=&quot;&gt;=&quot;&gt;&gt;=&lt;/option&gt;&#10;                            &lt;option value=&quot;&lt;=&quot;&gt;&lt;=&lt;/option&gt;&#10;                        &lt;/select&gt;&#10;                        &lt;input type=&quot;number&quot; step=&quot;0.1&quot; id=&quot;threshold&quot; required placeholder=&quot;30&quot; style=&quot;flex: 1;&quot;&gt;&#10;                    &lt;/div&gt;&#10;                &lt;/div&gt;&#10;                &lt;div class=&quot;form-group&quot;&gt;&#10;                    &lt;label&gt;Severity&lt;/label&gt;&#10;                    &lt;select id=&quot;severity&quot; required&gt;&#10;                        &lt;option value=&quot;LOW&quot;&gt;Low&lt;/option&gt;&#10;                        &lt;option value=&quot;MEDIUM&quot;&gt;Medium&lt;/option&gt;&#10;                        &lt;option value=&quot;HIGH&quot;&gt;High&lt;/option&gt;&#10;                        &lt;option value=&quot;EXTREME&quot;&gt;Extreme&lt;/option&gt;&#10;                    &lt;/select&gt;&#10;                &lt;/div&gt;&#10;                &lt;div class=&quot;form-group&quot;&gt;&#10;                    &lt;label&gt;Color&lt;/label&gt;&#10;                    &lt;input type=&quot;color&quot; id=&quot;color&quot; required value=&quot;#667eea&quot;&gt;&#10;                &lt;/div&gt;&#10;            &lt;/div&gt;&#10;            &lt;div class=&quot;form-group&quot;&gt;&#10;                &lt;label&gt;Alert Message&lt;/label&gt;&#10;                &lt;input type=&quot;text&quot; id=&quot;message&quot; required placeholder=&quot;Temperature alert!&quot;&gt;&#10;            &lt;/div&gt;&#10;            &lt;button type=&quot;submit&quot; class=&quot;btn-primary&quot;&gt;Add Alert Rule&lt;/button&gt;&#10;        &lt;/form&gt;&#10;&#10;        &lt;table id=&quot;alertsTable&quot;&gt;&#10;            &lt;thead&gt;&#10;            &lt;tr&gt;&#10;                &lt;th&gt;ID&lt;/th&gt;&#10;                &lt;th&gt;Type&lt;/th&gt;&#10;                &lt;th&gt;Condition&lt;/th&gt;&#10;                &lt;th&gt;Severity&lt;/th&gt;&#10;                &lt;th&gt;Color&lt;/th&gt;&#10;                &lt;th&gt;Message&lt;/th&gt;&#10;                &lt;th&gt;Status&lt;/th&gt;&#10;                &lt;th&gt;Actions&lt;/th&gt;&#10;            &lt;/tr&gt;&#10;            &lt;/thead&gt;&#10;            &lt;tbody id=&quot;alertsBody&quot;&gt;&#10;            &lt;tr&gt;&lt;td colspan=&quot;8&quot; class=&quot;empty-state&quot;&gt;Loading...&lt;/td&gt;&lt;/tr&gt;&#10;            &lt;/tbody&gt;&#10;        &lt;/table&gt;&#10;    &lt;/div&gt;&#10;&#10;    &lt;!-- Live Weather --&gt;&#10;    &lt;div class=&quot;section&quot;&gt;&#10;        &lt;div class=&quot;section-title&quot;&gt;️ Live Weather&lt;/div&gt;&#10;        &lt;div class=&quot;form-group&quot;&gt;&#10;            &lt;label&gt;City Name&lt;/label&gt;&#10;            &lt;input type=&quot;text&quot; id=&quot;grpcCity&quot; placeholder=&quot;Warsaw&quot;&gt;&#10;        &lt;/div&gt;&#10;        &lt;button class=&quot;btn-success&quot; onclick=&quot;getLiveWeather()&quot;&gt;Get Weather&lt;/button&gt;&#10;        &lt;div id=&quot;grpcLoading&quot; class=&quot;loading hidden&quot;&gt;Loading weather data...&lt;/div&gt;&#10;        &lt;div id=&quot;grpcResult&quot; class=&quot;hidden&quot;&gt;&lt;/div&gt;&#10;    &lt;/div&gt;&#10;&#10;    &lt;!-- ============================================ --&gt;&#10;    &lt;!-- DODAJ TĘ SEKCJĘ do index.html              --&gt;&#10;    &lt;!-- PO sekcji &quot;Live Weather&quot;                   --&gt;&#10;    &lt;!-- ============================================ --&gt;&#10;&#10;    &lt;!-- gRPC Server Streaming --&gt;&#10;    &lt;div class=&quot;section&quot;&gt;&#10;        &lt;div class=&quot;section-title&quot;&gt; gRPC Server Streaming - Live Updates&lt;/div&gt;&#10;        &lt;p style=&quot;color: #64748b; margin-bottom: 20px; font-size: 14px;&quot;&gt;&#10;            Real-time weather updates via gRPC server streaming • Multiple onNext() calls • Live data from OpenWeatherMap&#10;        &lt;/p&gt;&#10;&#10;        &lt;div class=&quot;form-row&quot;&gt;&#10;            &lt;div class=&quot;form-group&quot;&gt;&#10;                &lt;label&gt;City Name&lt;/label&gt;&#10;                &lt;input type=&quot;text&quot; id=&quot;streamCity&quot; placeholder=&quot;Warsaw&quot; value=&quot;Warsaw&quot;&gt;&#10;            &lt;/div&gt;&#10;            &lt;div class=&quot;form-group&quot;&gt;&#10;                &lt;label&gt;Number of Updates&lt;/label&gt;&#10;                &lt;input type=&quot;number&quot; id=&quot;streamUpdates&quot; placeholder=&quot;10&quot; value=&quot;10&quot; min=&quot;1&quot; max=&quot;20&quot;&gt;&#10;            &lt;/div&gt;&#10;            &lt;div class=&quot;form-group&quot;&gt;&#10;                &lt;label&gt;Interval (seconds)&lt;/label&gt;&#10;                &lt;input type=&quot;number&quot; id=&quot;streamInterval&quot; placeholder=&quot;5&quot; value=&quot;5&quot; min=&quot;2&quot; max=&quot;10&quot;&gt;&#10;            &lt;/div&gt;&#10;        &lt;/div&gt;&#10;&#10;        &lt;button class=&quot;btn-success&quot; onclick=&quot;startWeatherStream()&quot; id=&quot;streamButton&quot;&gt;&#10;             Start Live Stream&#10;        &lt;/button&gt;&#10;&#10;        &lt;div id=&quot;streamStatus&quot; style=&quot;margin-top: 20px; padding: 16px; border-radius: 8px; display: none;&quot;&gt;&lt;/div&gt;&#10;        &lt;div id=&quot;streamResult&quot; class=&quot;hidden&quot;&gt;&lt;/div&gt;&#10;    &lt;/div&gt;&#10;&#10;    &lt;script&gt;&#10;        // ============================================&#10;        // gRPC Streaming Function&#10;        // ============================================&#10;&#10;        let streamInProgress = false;&#10;        let currentEventSource = null;&#10;&#10;        async function startWeatherStream() {&#10;            if (streamInProgress) {&#10;                showToast('Stream already in progress!', 'error');&#10;                return;&#10;            }&#10;&#10;            const city = document.getElementById('streamCity').value.trim();&#10;            const updates = document.getElementById('streamUpdates').value;&#10;            const interval = document.getElementById('streamInterval').value;&#10;&#10;            if (!city) {&#10;                showToast('Enter a city name', 'error');&#10;                return;&#10;            }&#10;&#10;            const statusDiv = document.getElementById('streamStatus');&#10;            const resultDiv = document.getElementById('streamResult');&#10;            const button = document.getElementById('streamButton');&#10;&#10;            // Disable button&#10;            streamInProgress = true;&#10;            button.disabled = true;&#10;            button.style.opacity = '0.5';&#10;            button.textContent = '⏳ Streaming...';&#10;&#10;            // Show status&#10;            statusDiv.style.display = 'block';&#10;            statusDiv.style.background = 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)';&#10;            statusDiv.style.color = 'white';&#10;            statusDiv.innerHTML = `&#10;        &lt;div style=&quot;font-weight: 600; font-size: 16px; margin-bottom: 8px;&quot;&gt;&#10;             Live Weather Stream Started&#10;        &lt;/div&gt;&#10;        &lt;div style=&quot;font-size: 14px; opacity: 0.9;&quot;&gt;&#10;            City: ${city} | Updates: ${updates} | Interval: ${interval}s&#10;        &lt;/div&gt;&#10;        &lt;div style=&quot;margin-top: 12px; font-size: 13px;&quot;&gt;&#10;            ⏳ Fetching updates from OpenWeatherMap API in real-time...&#10;        &lt;/div&gt;&#10;    `;&#10;&#10;            // Create table with empty body&#10;            resultDiv.innerHTML = `&#10;        &lt;table style=&quot;margin-top: 20px;&quot;&gt;&#10;            &lt;thead&gt;&#10;                &lt;tr&gt;&#10;                    &lt;th&gt;#&lt;/th&gt;&#10;                    &lt;th&gt;City&lt;/th&gt;&#10;                    &lt;th&gt;Temperature&lt;/th&gt;&#10;                    &lt;th&gt;Description&lt;/th&gt;&#10;                    &lt;th&gt;Time&lt;/th&gt;&#10;                &lt;/tr&gt;&#10;            &lt;/thead&gt;&#10;            &lt;tbody id=&quot;streamTableBody&quot;&gt;&#10;                &lt;tr&gt;&#10;                    &lt;td colspan=&quot;5&quot; style=&quot;text-align: center; color: #64748b;&quot;&gt;&#10;                        ⏳ Waiting for first update...&#10;                    &lt;/td&gt;&#10;                &lt;/tr&gt;&#10;            &lt;/tbody&gt;&#10;        &lt;/table&gt;&#10;    `;&#10;            resultDiv.classList.remove('hidden');&#10;&#10;            const startTime = Date.now();&#10;            let updateCount = 0;&#10;&#10;            // Use Server-Sent Events (SSE) for real-time streaming!&#10;            const eventSource = new EventSource(&#10;                `http://localhost:8085/api/weather/stream-sse/${city}?updates=${updates}&amp;intervalSeconds=${interval}`&#10;            );&#10;            currentEventSource = eventSource;&#10;&#10;            // Listen for weather updates&#10;            eventSource.addEventListener('weather-update', (event) =&gt; {&#10;                const update = JSON.parse(event.data);&#10;                updateCount++;&#10;&#10;                console.log(' Received update:', update);&#10;&#10;                // Add row to table in real-time!&#10;                addStreamUpdateRow(update);&#10;&#10;                // Update status with current progress&#10;                const elapsed = ((Date.now() - startTime) / 1000).toFixed(1);&#10;                statusDiv.innerHTML = `&#10;            &lt;div style=&quot;font-weight: 600; font-size: 16px; margin-bottom: 8px;&quot;&gt;&#10;                 Streaming... (${updateCount}/${updates})&#10;            &lt;/div&gt;&#10;            &lt;div style=&quot;font-size: 14px; opacity: 0.9;&quot;&gt;&#10;                City: ${city} | Elapsed: ${elapsed}s&#10;            &lt;/div&gt;&#10;            &lt;div style=&quot;margin-top: 12px; font-size: 13px; animation: pulse 2s infinite;&quot;&gt;&#10;                 Receiving live updates...&#10;            &lt;/div&gt;&#10;        `;&#10;            });&#10;&#10;            // Stream completed&#10;            eventSource.addEventListener('error', (event) =&gt; {&#10;                console.log('Stream ended or error occurred');&#10;                eventSource.close();&#10;                currentEventSource = null;&#10;&#10;                const elapsed = ((Date.now() - startTime) / 1000).toFixed(1);&#10;&#10;                statusDiv.style.background = 'linear-gradient(135deg, #10b981 0%, #059669 100%)';&#10;                statusDiv.innerHTML = `&#10;            &lt;div style=&quot;font-weight: 600; font-size: 16px; margin-bottom: 8px;&quot;&gt;&#10;                ✅ Stream Completed Successfully!&#10;            &lt;/div&gt;&#10;            &lt;div style=&quot;font-size: 14px;&quot;&gt;&#10;                Received ${updateCount} updates in ${elapsed}s&#10;            &lt;/div&gt;&#10;        `;&#10;&#10;                showToast(`✅ Stream completed! ${updateCount} updates received`);&#10;&#10;                // Re-enable button&#10;                streamInProgress = false;&#10;                button.disabled = false;&#10;                button.style.opacity = '1';&#10;                button.textContent = ' Start Live Stream';&#10;            });&#10;        }&#10;&#10;        function addStreamUpdateRow(update) {&#10;            const tbody = document.getElementById('streamTableBody');&#10;&#10;            // Remove &quot;waiting&quot; message if it exists&#10;            if (tbody.querySelector('td[colspan=&quot;5&quot;]')) {&#10;                tbody.innerHTML = '';&#10;            }&#10;&#10;            // Create new row (no animation - just appears)&#10;            const row = document.createElement('tr');&#10;            row.innerHTML = `&#10;        &lt;td style=&quot;font-weight: 700; color: #3b82f6;&quot;&gt;#${update.updateNumber}&lt;/td&gt;&#10;        &lt;td&gt;${update.city}&lt;/td&gt;&#10;        &lt;td style=&quot;font-weight: 700; color: #10b981;&quot;&gt;${update.temperature.toFixed(1)}°C&lt;/td&gt;&#10;        &lt;td&gt;${update.description}&lt;/td&gt;&#10;        &lt;td style=&quot;color: #64748b; font-size: 13px;&quot;&gt;${new Date(update.timestamp).toLocaleTimeString()}&lt;/td&gt;&#10;    `;&#10;&#10;            // Add to table (newest at bottom)&#10;            tbody.appendChild(row);&#10;&#10;            // Scroll to bottom to show newest update&#10;            row.scrollIntoView({ behavior: 'smooth', block: 'nearest' });&#10;        }&#10;&#10;        function displayStreamUpdates(updates) {&#10;            const tbody = document.getElementById('streamTableBody');&#10;&#10;            if (!updates || updates.length === 0) {&#10;                tbody.innerHTML = `&#10;            &lt;tr&gt;&#10;                &lt;td colspan=&quot;5&quot; class=&quot;empty-state&quot;&gt;No updates received&lt;/td&gt;&#10;            &lt;/tr&gt;&#10;        `;&#10;                return;&#10;            }&#10;&#10;            tbody.innerHTML = updates.map(update =&gt; `&#10;        &lt;tr&gt;&#10;            &lt;td style=&quot;font-weight: 700; color: #3b82f6;&quot;&gt;#${update.updateNumber}&lt;/td&gt;&#10;            &lt;td&gt;${update.city}&lt;/td&gt;&#10;            &lt;td style=&quot;font-weight: 700; color: #10b981;&quot;&gt;${update.temperature.toFixed(1)}°C&lt;/td&gt;&#10;            &lt;td&gt;${update.description}&lt;/td&gt;&#10;            &lt;td style=&quot;color: #64748b; font-size: 13px;&quot;&gt;${update.timestamp}&lt;/td&gt;&#10;        &lt;/tr&gt;&#10;    `).join('');&#10;        }&#10;    &lt;/script&gt;&#10;&#10;    &lt;!-- Async gRPC (Compact) --&gt;&#10;    &lt;div class=&quot;section compact-section&quot;&gt;&#10;        &lt;div class=&quot;section-title&quot;&gt; Async gRPC Demo&lt;/div&gt;&#10;        &lt;p&gt;Non-blocking call with StreamObserver. Server responds immediately.&lt;/p&gt;&#10;        &lt;div class=&quot;form-group&quot;&gt;&#10;            &lt;input type=&quot;text&quot; id=&quot;asyncCity&quot; placeholder=&quot;City name&quot; style=&quot;margin-bottom: 12px;&quot;&gt;&#10;        &lt;/div&gt;&#10;        &lt;button class=&quot;btn-primary&quot; onclick=&quot;testAsyncGrpc()&quot;&gt;Test Async&lt;/button&gt;&#10;        &lt;div id=&quot;asyncLoading&quot; class=&quot;loading hidden&quot;&gt;Calling...&lt;/div&gt;&#10;        &lt;div id=&quot;asyncResult&quot; class=&quot;hidden&quot;&gt;&lt;/div&gt;&#10;    &lt;/div&gt;&#10;&#10;    &lt;!-- SOAP Report --&gt;&#10;    &lt;div class=&quot;section&quot;&gt;&#10;        &lt;div class=&quot;section-title&quot;&gt; Weather Report (SOAP)&lt;/div&gt;&#10;        &lt;div class=&quot;form-group&quot;&gt;&#10;            &lt;label&gt;City Name&lt;/label&gt;&#10;            &lt;input type=&quot;text&quot; id=&quot;soapCity&quot; placeholder=&quot;Warsaw&quot;&gt;&#10;        &lt;/div&gt;&#10;        &lt;button class=&quot;btn-success&quot; onclick=&quot;generateReport()&quot;&gt;Generate Report&lt;/button&gt;&#10;        &lt;div id=&quot;soapLoading&quot; class=&quot;loading hidden&quot;&gt;Generating report...&lt;/div&gt;&#10;        &lt;div id=&quot;soapResult&quot; class=&quot;hidden&quot;&gt;&lt;/div&gt;&#10;    &lt;/div&gt;&#10;&#10;    &lt;!-- Historical Data --&gt;&#10;    &lt;div class=&quot;section&quot;&gt;&#10;        &lt;div class=&quot;section-title&quot;&gt; Historical Data (XML-RPC)&lt;/div&gt;&#10;        &lt;div class=&quot;form-group&quot;&gt;&#10;            &lt;label&gt;City Name&lt;/label&gt;&#10;            &lt;input type=&quot;text&quot; id=&quot;xmlrpcCity&quot; placeholder=&quot;Warsaw&quot;&gt;&#10;        &lt;/div&gt;&#10;        &lt;button class=&quot;btn-success&quot; onclick=&quot;getHistoricalWeather()&quot;&gt;Get History&lt;/button&gt;&#10;        &lt;div id=&quot;xmlrpcLoading&quot; class=&quot;loading hidden&quot;&gt;Loading history...&lt;/div&gt;&#10;        &lt;div id=&quot;xmlrpcResult&quot; class=&quot;hidden&quot;&gt;&lt;/div&gt;&#10;    &lt;/div&gt;&#10;&lt;/div&gt;&#10;&#10;&lt;script&gt;&#10;    const ALERTS_API = 'http://localhost:8084/api/alert-rules';&#10;    const GRPC_API = 'http://localhost:8085/api/weather';&#10;    const SOAP_API = 'http://localhost:8085/api/report';&#10;    const XMLRPC_API = 'http://localhost:8088/xmlrpc/historical';&#10;&#10;    let triggeredAlert = null; // Store alert info globally&#10;    let alertsWithLinks = {}; // Store HATEOAS links for each alert&#10;&#10;    window.onload = () =&gt; {&#10;        loadAlerts();&#10;    };&#10;&#10;    // ALERTS CRUD&#10;    async function loadAlerts() {&#10;        try {&#10;            const response = await fetch(`${ALERTS_API}?page=0&amp;size=20&amp;sortBy=createdAt`);&#10;            const data = await response.json();&#10;&#10;            // Store alerts with their HATEOAS links&#10;            alertsWithLinks = {};&#10;            data.content.forEach(alert =&gt; {&#10;                // Handle both formats: _links (object) and links (array)&#10;                if (alert._links) {&#10;                    alertsWithLinks[alert.id] = alert._links;&#10;                } else if (alert.links &amp;&amp; Array.isArray(alert.links)) {&#10;                    // Convert array format to object format&#10;                    const linksObj = {};&#10;                    alert.links.forEach(link =&gt; {&#10;                        linksObj[link.rel] = { href: link.href };&#10;                    });&#10;                    alertsWithLinks[alert.id] = linksObj;&#10;                }&#10;            });&#10;&#10;            console.log(' HATEOAS links loaded:', alertsWithLinks);&#10;            displayAlerts(data.content);&#10;        } catch (error) {&#10;            showToast('Failed to load alerts', 'error');&#10;        }&#10;    }&#10;&#10;    function displayAlerts(alerts) {&#10;        const tbody = document.getElementById('alertsBody');&#10;        if (alerts.length === 0) {&#10;            tbody.innerHTML = '&lt;tr&gt;&lt;td colspan=&quot;8&quot; class=&quot;empty-state&quot;&gt;No alerts yet&lt;/td&gt;&lt;/tr&gt;';&#10;            return;&#10;        }&#10;        tbody.innerHTML = alerts.map(alert =&gt; `&#10;            &lt;tr id=&quot;row-${alert.id}&quot;&gt;&#10;                &lt;td&gt;${alert.id}&lt;/td&gt;&#10;                &lt;td&gt;${alert.alertType}&lt;/td&gt;&#10;                &lt;td&gt;${alert.operator} ${alert.threshold}&lt;/td&gt;&#10;                &lt;td&gt;&lt;span class=&quot;alert-badge&quot; style=&quot;background:${getSeverityColor(alert.severity)}&quot;&gt;${alert.severity}&lt;/span&gt;&lt;/td&gt;&#10;                &lt;td&gt;&lt;span class=&quot;color-preview&quot; style=&quot;background:${alert.color}&quot;&gt;&lt;/span&gt;&lt;/td&gt;&#10;                &lt;td&gt;${alert.message}&lt;/td&gt;&#10;                &lt;td style=&quot;color:${alert.active ? '#48bb78' : '#a0aec0'};font-weight:600&quot;&gt;${alert.active ? 'Active' : 'Inactive'}&lt;/td&gt;&#10;                &lt;td&gt;&#10;                    &lt;button class=&quot;btn-edit&quot; onclick=&quot;editAlert(${alert.id})&quot;&gt;Edit&lt;/button&gt;&#10;                    &lt;button class=&quot;btn-warning&quot; onclick=&quot;toggleAlert(${alert.id})&quot;&gt;${alert.active ? 'Disable' : 'Enable'}&lt;/button&gt;&#10;                    &lt;button class=&quot;btn-danger&quot; onclick=&quot;deleteAlert(${alert.id})&quot;&gt;Delete&lt;/button&gt;&#10;                &lt;/td&gt;&#10;            &lt;/tr&gt;&#10;        `).join('');&#10;    }&#10;&#10;    function getSeverityColor(severity) {&#10;        const colors = {'LOW': '#48bb78', 'MEDIUM': '#ed8936', 'HIGH': '#f56565', 'EXTREME': '#9b2c2c'};&#10;        return colors[severity] || '#718096';&#10;    }&#10;&#10;    async function addAlert(event) {&#10;        event.preventDefault();&#10;        const data = {&#10;            alertType: document.getElementById('alertType').value,&#10;            threshold: parseFloat(document.getElementById('threshold').value),&#10;            operator: document.getElementById('operator').value,&#10;            severity: document.getElementById('severity').value,&#10;            color: document.getElementById('color').value,&#10;            message: document.getElementById('message').value,&#10;            active: true&#10;        };&#10;        try {&#10;            const response = await fetch(ALERTS_API, {&#10;                method: 'POST',&#10;                headers: {'Content-Type': 'application/json'},&#10;                body: JSON.stringify(data)&#10;            });&#10;            if (response.ok) {&#10;                showToast('Alert added!');&#10;                document.getElementById('alertForm').reset();&#10;                loadAlerts();&#10;            } else {&#10;                showToast('Failed to add alert', 'error');&#10;            }&#10;        } catch (error) {&#10;            showToast('Error: ' + error.message, 'error');&#10;        }&#10;    }&#10;&#10;    function editAlert(id) {&#10;        const row = document.getElementById(`row-${id}`);&#10;        const cells = row.cells;&#10;        document.getElementById('editId').value = id;&#10;        document.getElementById('editAlertType').value = cells[1].textContent;&#10;        const condition = cells[2].textContent.trim().split(' ');&#10;        document.getElementById('editOperator').value = condition[0];&#10;        document.getElementById('editThreshold').value = parseFloat(condition[1]);&#10;        document.getElementById('editSeverity').value = cells[3].textContent.trim();&#10;        document.getElementById('editColor').value = cells[4].querySelector('.color-preview').style.background;&#10;        document.getElementById('editMessage').value = cells[5].textContent;&#10;        document.getElementById('editModal').classList.add('show');&#10;    }&#10;&#10;    function closeEditModal() {&#10;        document.getElementById('editModal').classList.remove('show');&#10;    }&#10;&#10;    async function saveEdit(event) {&#10;        event.preventDefault();&#10;        const id = document.getElementById('editId').value;&#10;        const data = {&#10;            alertType: document.getElementById('editAlertType').value,&#10;            threshold: parseFloat(document.getElementById('editThreshold').value),&#10;            operator: document.getElementById('editOperator').value,&#10;            severity: document.getElementById('editSeverity').value,&#10;            color: document.getElementById('editColor').value,&#10;            message: document.getElementById('editMessage').value,&#10;            active: true&#10;        };&#10;        try {&#10;            // Use HATEOAS link if available, otherwise fallback to manual URL&#10;            const updateUrl = alertsWithLinks[id]?.update?.href || `${ALERTS_API}/${id}`;&#10;&#10;            const response = await fetch(updateUrl, {&#10;                method: 'PUT',&#10;                headers: {'Content-Type': 'application/json'},&#10;                body: JSON.stringify(data)&#10;            });&#10;            if (response.ok) {&#10;                showToast('✅ Alert updated using HATEOAS!');&#10;                closeEditModal();&#10;                loadAlerts();&#10;            } else {&#10;                showToast('Failed to update', 'error');&#10;            }&#10;        } catch (error) {&#10;            showToast('Error: ' + error.message, 'error');&#10;        }&#10;    }&#10;&#10;    async function toggleAlert(id) {&#10;        try {&#10;            // Use HATEOAS link if available, otherwise fallback to manual URL&#10;            const toggleUrl = alertsWithLinks[id]?.toggle?.href || `${ALERTS_API}/${id}/toggle`;&#10;&#10;            const response = await fetch(toggleUrl, {method: 'PATCH'});&#10;            if (response.ok) {&#10;                showToast('✅ Status toggled using HATEOAS!');&#10;                loadAlerts();&#10;            }&#10;        } catch (error) {&#10;            showToast('Error: ' + error.message, 'error');&#10;        }&#10;    }&#10;&#10;    async function deleteAlert(id) {&#10;        if (!confirm('Delete this alert?')) return;&#10;        try {&#10;            // Use HATEOAS link if available, otherwise fallback to manual URL&#10;            const deleteUrl = alertsWithLinks[id]?.delete?.href || `${ALERTS_API}/${id}`;&#10;&#10;            const response = await fetch(deleteUrl, {method: 'DELETE'});&#10;            if (response.ok) {&#10;                showToast('✅ Alert deleted using HATEOAS!');&#10;                loadAlerts();&#10;            }&#10;        } catch (error) {&#10;            showToast('Error: ' + error.message, 'error');&#10;        }&#10;    }&#10;&#10;    // LIVE WEATHER with ALERT MESSAGE&#10;    async function getLiveWeather() {&#10;        const city = document.getElementById('grpcCity').value.trim();&#10;        if (!city) {&#10;            showToast('Enter a city name', 'error');&#10;            return;&#10;        }&#10;&#10;        const loading = document.getElementById('grpcLoading');&#10;        const result = document.getElementById('grpcResult');&#10;        loading.classList.remove('hidden');&#10;        result.classList.add('hidden');&#10;&#10;        try {&#10;            // Get weather&#10;            const response = await fetch(`${GRPC_API}/${city}`);&#10;            const data = await response.json();&#10;&#10;            // Get active alerts to find triggered one&#10;            const alertsResponse = await fetch(`${ALERTS_API}?page=0&amp;size=100`);&#10;            const alertsData = await alertsResponse.json();&#10;&#10;            // Find matching alert&#10;            triggeredAlert = null;&#10;            if (data.status === 'ALERT') {&#10;                const activeAlerts = alertsData.content.filter(a =&gt; a.active &amp;&amp; a.alertType === 'TEMPERATURE');&#10;                for (let alert of activeAlerts) {&#10;                    if (eval(`${data.temperature} ${alert.operator} ${alert.threshold}`)) {&#10;                        triggeredAlert = alert;&#10;                        break;&#10;                    }&#10;                }&#10;            }&#10;&#10;            result.innerHTML = `&#10;                &lt;div class=&quot;weather-card&quot;&gt;&#10;                    &lt;div class=&quot;weather-card-content&quot;&gt;&#10;                        &lt;div class=&quot;weather-city&quot;&gt;${data.city}&lt;/div&gt;&#10;                        &lt;div class=&quot;weather-temp&quot;&gt;${data.temperature.toFixed(1)}°&lt;/div&gt;&#10;                        &lt;div class=&quot;weather-desc&quot;&gt;${data.description}&lt;/div&gt;&#10;                        &lt;div class=&quot;weather-status&quot;&gt;${data.status}&lt;/div&gt;&#10;                        ${triggeredAlert ? `&#10;                            &lt;div class=&quot;alert-message-box&quot; style=&quot;border-left: 4px solid ${triggeredAlert.color}&quot;&gt;&#10;                                &lt;div class=&quot;alert-icon&quot;&gt;⚠️&lt;/div&gt;&#10;                                &lt;div class=&quot;alert-content&quot;&gt;&#10;                                    &lt;div class=&quot;alert-title&quot;&gt;${triggeredAlert.severity} Alert&lt;/div&gt;&#10;                                    &lt;div class=&quot;alert-text&quot;&gt;${triggeredAlert.message}&lt;/div&gt;&#10;                                &lt;/div&gt;&#10;                            &lt;/div&gt;&#10;                        ` : ''}&#10;                    &lt;/div&gt;&#10;                &lt;/div&gt;&#10;            `;&#10;            result.classList.remove('hidden');&#10;        } catch (error) {&#10;            showToast('Failed to get weather', 'error');&#10;        } finally {&#10;            loading.classList.add('hidden');&#10;        }&#10;    }&#10;&#10;    // ASYNC gRPC (Compact)&#10;    async function testAsyncGrpc() {&#10;        const city = document.getElementById('asyncCity').value.trim();&#10;        if (!city) {&#10;            showToast('Enter a city', 'error');&#10;            return;&#10;        }&#10;        const loading = document.getElementById('asyncLoading');&#10;        const result = document.getElementById('asyncResult');&#10;        loading.classList.remove('hidden');&#10;        result.classList.add('hidden');&#10;        try {&#10;            const response = await fetch(`http://localhost:8085/api/weather/async/${city}`);&#10;            const data = await response.json();&#10;            result.innerHTML = `&#10;                &lt;div style=&quot;margin-top:16px;padding:16px;background:#f7fafc;border-radius:8px;text-align:center&quot;&gt;&#10;                    &lt;div style=&quot;font-weight:600;margin-bottom:8px&quot;&gt;✅ Response: ${data.responseTime}&lt;/div&gt;&#10;                    &lt;div style=&quot;font-size:13px;color:#718096&quot;&gt;${data.info}&lt;/div&gt;&#10;                &lt;/div&gt;&#10;            `;&#10;            result.classList.remove('hidden');&#10;        } catch (error) {&#10;            showToast('Async failed', 'error');&#10;        } finally {&#10;            loading.classList.add('hidden');&#10;        }&#10;    }&#10;&#10;    // SOAP REPORT&#10;    async function generateReport() {&#10;        const city = document.getElementById('soapCity').value.trim();&#10;        if (!city) {&#10;            showToast('Enter a city', 'error');&#10;            return;&#10;        }&#10;        const loading = document.getElementById('soapLoading');&#10;        const result = document.getElementById('soapResult');&#10;        loading.classList.remove('hidden');&#10;        result.classList.add('hidden');&#10;        try {&#10;            const response = await fetch(`${SOAP_API}/${city}?days=7`);&#10;            const data = await response.json();&#10;            result.innerHTML = `&#10;                &lt;div class=&quot;report-grid&quot;&gt;&#10;                    &lt;div class=&quot;report-item&quot;&gt;&lt;div class=&quot;label&quot;&gt;City&lt;/div&gt;&lt;div class=&quot;value&quot;&gt;${data.city}&lt;/div&gt;&lt;/div&gt;&#10;                    &lt;div class=&quot;report-item&quot;&gt;&lt;div class=&quot;label&quot;&gt;Avg Temp&lt;/div&gt;&lt;div class=&quot;value&quot;&gt;${data.avgTemp}°C&lt;/div&gt;&lt;/div&gt;&#10;                    &lt;div class=&quot;report-item&quot;&gt;&lt;div class=&quot;label&quot;&gt;Min Temp&lt;/div&gt;&lt;div class=&quot;value&quot;&gt;${data.minTemp}°C&lt;/div&gt;&lt;/div&gt;&#10;                    &lt;div class=&quot;report-item&quot;&gt;&lt;div class=&quot;label&quot;&gt;Max Temp&lt;/div&gt;&lt;div class=&quot;value&quot;&gt;${data.maxTemp}°C&lt;/div&gt;&lt;/div&gt;&#10;                &lt;/div&gt;&#10;                &lt;div style=&quot;margin-top:20px;padding:20px;background:#f7fafc;border-radius:12px;font-size:14px;line-height:1.6&quot;&gt;&#10;                    ${data.summary}&#10;                &lt;/div&gt;&#10;            `;&#10;            result.classList.remove('hidden');&#10;        } catch (error) {&#10;            showToast('Failed to generate report', 'error');&#10;        } finally {&#10;            loading.classList.add('hidden');&#10;        }&#10;    }&#10;&#10;    // HISTORICAL&#10;    async function getHistoricalWeather() {&#10;        const city = document.getElementById('xmlrpcCity').value.trim();&#10;        if (!city) {&#10;            showToast('Enter a city', 'error');&#10;            return;&#10;        }&#10;        const loading = document.getElementById('xmlrpcLoading');&#10;        const result = document.getElementById('xmlrpcResult');&#10;        loading.classList.remove('hidden');&#10;        result.classList.add('hidden');&#10;        try {&#10;            const response = await fetch(`${XMLRPC_API}?city=${city}&amp;days=5`);&#10;            const data = await response.json();&#10;            if (Array.isArray(data) &amp;&amp; data.length &gt; 0) {&#10;                result.innerHTML = `&#10;                    &lt;table&gt;&#10;                        &lt;thead&gt;&lt;tr&gt;&lt;th&gt;Date/Time&lt;/th&gt;&lt;th&gt;Temp&lt;/th&gt;&lt;th&gt;Description&lt;/th&gt;&lt;th&gt;Humidity&lt;/th&gt;&lt;/tr&gt;&lt;/thead&gt;&#10;                        &lt;tbody&gt;&#10;                            ${data.map(day =&gt; `&#10;                                &lt;tr&gt;&#10;                                    &lt;td&gt;${day.timestamp ? new Date(day.timestamp).toLocaleString('pl-PL') : 'N/A'}&lt;/td&gt;&#10;                                    &lt;td&gt;${day.temperature ? day.temperature.toFixed(1) : 'N/A'}°C&lt;/td&gt;&#10;                                    &lt;td&gt;${day.description || 'N/A'}&lt;/td&gt;&#10;                                    &lt;td&gt;${day.humidity || 'N/A'}%&lt;/td&gt;&#10;                                &lt;/tr&gt;&#10;                            `).join('')}&#10;                        &lt;/tbody&gt;&#10;                    &lt;/table&gt;&#10;                `;&#10;            } else {&#10;                result.innerHTML = '&lt;div class=&quot;empty-state&quot;&gt;No data. Check weather first!&lt;/div&gt;';&#10;            }&#10;            result.classList.remove('hidden');&#10;        } catch (error) {&#10;            showToast('Failed to get history', 'error');&#10;        } finally {&#10;            loading.classList.add('hidden');&#10;        }&#10;    }&#10;&#10;    function showToast(message, type = 'success') {&#10;        const toast = document.getElementById('toast');&#10;        toast.textContent = message;&#10;        toast.className = `toast ${type}`;&#10;        toast.style.display = 'block';&#10;        setTimeout(() =&gt; toast.style.display = 'none', 3000);&#10;    }&#10;&lt;/script&gt;&#10;&#10;&lt;!-- ============================================ --&gt;&#10;&lt;!-- NOWA SEKCJA XML-RPC                         --&gt;&#10;&lt;!-- Zamień całą sekcję &quot;Historical Data&quot; na tę!--&gt;&#10;&lt;!-- ============================================ --&gt;&#10;&#10;&lt;!-- XML-RPC Historical Data --&gt;&#10;&lt;div class=&quot;section&quot;&gt;&#10;    &lt;div class=&quot;section-title&quot;&gt; XML-RPC Historical Data&lt;/div&gt;&#10;    &lt;p style=&quot;color: #64748b; margin-bottom: 20px; font-size: 14px;&quot;&gt;&#10;        Apache XML-RPC protocol • Synchronous + Asynchronous (3-second delay) • Connected to real database&#10;    &lt;/p&gt;&#10;&#10;    &lt;div class=&quot;form-row&quot;&gt;&#10;        &lt;div class=&quot;form-group&quot;&gt;&#10;            &lt;label&gt;City Name&lt;/label&gt;&#10;            &lt;input type=&quot;text&quot; id=&quot;xmlrpcCityNew&quot; placeholder=&quot;Warsaw&quot; value=&quot;Warsaw&quot;&gt;&#10;        &lt;/div&gt;&#10;        &lt;div class=&quot;form-group&quot;&gt;&#10;            &lt;label&gt;Number of Days&lt;/label&gt;&#10;            &lt;input type=&quot;number&quot; id=&quot;xmlrpcDaysNew&quot; placeholder=&quot;5&quot; value=&quot;5&quot; min=&quot;1&quot; max=&quot;10&quot;&gt;&#10;        &lt;/div&gt;&#10;    &lt;/div&gt;&#10;&#10;    &lt;div style=&quot;display: flex; gap: 12px; flex-wrap: wrap; margin-bottom: 20px;&quot;&gt;&#10;        &lt;button class=&quot;btn-primary&quot; onclick=&quot;getXmlRpcHistoryNew()&quot;&gt;&#10;            ⚡ Get History (Sync)&#10;        &lt;/button&gt;&#10;        &lt;button class=&quot;btn-success&quot; onclick=&quot;getXmlRpcHistoryAsyncNew()&quot;&gt;&#10;            ⏱️ Get History (Async 3s)&#10;        &lt;/button&gt;&#10;        &lt;button style=&quot;padding: 14px 28px; font-size: 16px; font-weight: 600; border: none; border-radius: 10px; cursor: pointer; background: linear-gradient(135deg, #06b6d4 0%, #0891b2 100%); color: white;&quot;&#10;                onclick=&quot;getXmlRpcStatisticsNew()&quot;&gt;&#10;             Get Statistics&#10;        &lt;/button&gt;&#10;    &lt;/div&gt;&#10;&#10;    &lt;div id=&quot;xmlrpcStatusNew&quot; class=&quot;loading hidden&quot;&gt;&lt;/div&gt;&#10;    &lt;div id=&quot;xmlrpcResultNew&quot; class=&quot;hidden&quot;&gt;&lt;/div&gt;&#10;&lt;/div&gt;&#10;&#10;&lt;script&gt;&#10;    // ============================================&#10;    // XML-RPC Functions - POPRAWIONE!&#10;    // ============================================&#10;&#10;    async function getXmlRpcHistoryNew() {&#10;        const city = document.getElementById('xmlrpcCityNew').value.trim();&#10;        const days = document.getElementById('xmlrpcDaysNew').value;&#10;&#10;        if (!city) {&#10;            showToast('Enter a city name', 'error');&#10;            return;&#10;        }&#10;&#10;        const statusDiv = document.getElementById('xmlrpcStatusNew');&#10;        const resultDiv = document.getElementById('xmlrpcResultNew');&#10;&#10;        statusDiv.textContent = '⏳ Calling XML-RPC Server (synchronous)...';&#10;        statusDiv.classList.remove('hidden');&#10;        resultDiv.classList.add('hidden');&#10;&#10;        try {&#10;            const response = await fetch(`http://localhost:8085/api/xmlrpc-proxy/history/${city}?days=${days}`);&#10;            const data = await response.json();&#10;&#10;            statusDiv.classList.add('hidden');&#10;            displayXmlRpcHistoryNew(data, false);&#10;            showToast('✅ XML-RPC sync call completed!');&#10;&#10;        } catch (error) {&#10;            statusDiv.classList.add('hidden');&#10;            showToast('Failed to call XML-RPC: ' + error.message, 'error');&#10;        }&#10;    }&#10;&#10;    async function getXmlRpcHistoryAsyncNew() {&#10;        const city = document.getElementById('xmlrpcCityNew').value.trim();&#10;        const days = document.getElementById('xmlrpcDaysNew').value;&#10;&#10;        if (!city) {&#10;            showToast('Enter a city name', 'error');&#10;            return;&#10;        }&#10;&#10;        const statusDiv = document.getElementById('xmlrpcStatusNew');&#10;        const resultDiv = document.getElementById('xmlrpcResultNew');&#10;&#10;        statusDiv.textContent = '⏳ Calling XML-RPC Server (async with 3-second delay)... Please wait...';&#10;        statusDiv.classList.remove('hidden');&#10;        resultDiv.classList.add('hidden');&#10;&#10;        const startTime = Date.now();&#10;&#10;        try {&#10;            const response = await fetch(`http://localhost:8085/api/xmlrpc-proxy/history-async/${city}?days=${days}`);&#10;            const data = await response.json();&#10;&#10;            const elapsed = ((Date.now() - startTime) / 1000).toFixed(1);&#10;&#10;            statusDiv.classList.add('hidden');&#10;            displayXmlRpcHistoryNew(data, true, elapsed);&#10;            showToast(`✅ XML-RPC async completed! (${elapsed}s with 3s server delay)`);&#10;&#10;        } catch (error) {&#10;            statusDiv.classList.add('hidden');&#10;            showToast('Failed to call XML-RPC: ' + error.message, 'error');&#10;        }&#10;    }&#10;&#10;    async function getXmlRpcStatisticsNew() {&#10;        const city = document.getElementById('xmlrpcCityNew').value.trim();&#10;&#10;        if (!city) {&#10;            showToast('Enter a city name', 'error');&#10;            return;&#10;        }&#10;&#10;        const statusDiv = document.getElementById('xmlrpcStatusNew');&#10;        const resultDiv = document.getElementById('xmlrpcResultNew');&#10;&#10;        statusDiv.textContent = '⏳ Getting statistics via XML-RPC...';&#10;        statusDiv.classList.remove('hidden');&#10;        resultDiv.classList.add('hidden');&#10;&#10;        try {&#10;            const response = await fetch(`http://localhost:8085/api/xmlrpc-proxy/statistics/${city}`);&#10;            const data = await response.json();&#10;&#10;            statusDiv.classList.add('hidden');&#10;            displayXmlRpcStatisticsNew(data);&#10;            showToast('✅ Statistics retrieved via XML-RPC!');&#10;&#10;        } catch (error) {&#10;            statusDiv.classList.add('hidden');&#10;            showToast('Failed to get statistics: ' + error.message, 'error');&#10;        }&#10;    }&#10;&#10;    function displayXmlRpcHistoryNew(data, isAsync, elapsed) {&#10;        const resultDiv = document.getElementById('xmlrpcResultNew');&#10;&#10;        if (!Array.isArray(data) || data.length === 0) {&#10;            resultDiv.innerHTML = '&lt;div class=&quot;empty-state&quot;&gt;No historical data available. Check weather first!&lt;/div&gt;';&#10;            resultDiv.classList.remove('hidden');&#10;            return;&#10;        }&#10;&#10;        let html = `&#10;        &lt;div style=&quot;padding: 20px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 12px; color: white; margin-bottom: 20px;&quot;&gt;&#10;            &lt;div style=&quot;font-size: 18px; font-weight: 600; margin-bottom: 8px;&quot;&gt;&#10;                ${isAsync ? '⏱️ Asynchronous Call' : '⚡ Synchronous Call'}&#10;            &lt;/div&gt;&#10;            &lt;div style=&quot;font-size: 14px; opacity: 0.9;&quot;&gt;&#10;                Retrieved ${data.length} records from Weather Provider via XML-RPC protocol&#10;                ${isAsync ? ` • Completed in ${elapsed}s (includes 3s server delay)` : ''}&#10;            &lt;/div&gt;&#10;        &lt;/div&gt;&#10;        &lt;table&gt;&#10;            &lt;thead&gt;&#10;                &lt;tr&gt;&#10;                    &lt;th&gt;#&lt;/th&gt;&#10;                    &lt;th&gt;City&lt;/th&gt;&#10;                    &lt;th&gt;Temperature&lt;/th&gt;&#10;                    &lt;th&gt;Description&lt;/th&gt;&#10;                    &lt;th&gt;Timestamp&lt;/th&gt;&#10;                &lt;/tr&gt;&#10;            &lt;/thead&gt;&#10;            &lt;tbody&gt;&#10;    `;&#10;&#10;        data.forEach((record, index) =&gt; {&#10;            html += `&#10;            &lt;tr&gt;&#10;                &lt;td&gt;${index + 1}&lt;/td&gt;&#10;                &lt;td&gt;${record.city || 'Unknown'}&lt;/td&gt;&#10;                &lt;td style=&quot;font-weight: 700; color: #3b82f6;&quot;&gt;${record.temperature ? record.temperature.toFixed(1) : 'N/A'}°C&lt;/td&gt;&#10;                &lt;td&gt;${record.description || 'N/A'}&lt;/td&gt;&#10;                &lt;td style=&quot;color: #64748b; font-size: 14px;&quot;&gt;${record.timestamp || record.date || 'N/A'}&lt;/td&gt;&#10;            &lt;/tr&gt;&#10;        `;&#10;        });&#10;&#10;        html += `&#10;            &lt;/tbody&gt;&#10;        &lt;/table&gt;&#10;    `;&#10;&#10;        resultDiv.innerHTML = html;&#10;        resultDiv.classList.remove('hidden');&#10;    }&#10;&#10;    function displayXmlRpcStatisticsNew(data) {&#10;        const resultDiv = document.getElementById('xmlrpcResultNew');&#10;&#10;        if (data.error) {&#10;            resultDiv.innerHTML = `&lt;div class=&quot;empty-state&quot;&gt;⚠️ ${data.error}&lt;/div&gt;`;&#10;            resultDiv.classList.remove('hidden');&#10;            return;&#10;        }&#10;&#10;        resultDiv.innerHTML = `&#10;        &lt;div class=&quot;report-grid&quot;&gt;&#10;            &lt;div class=&quot;report-item&quot;&gt;&#10;                &lt;div class=&quot;label&quot;&gt;City&lt;/div&gt;&#10;                &lt;div class=&quot;value&quot;&gt;${data.city || 'Unknown'}&lt;/div&gt;&#10;            &lt;/div&gt;&#10;            &lt;div class=&quot;report-item&quot;&gt;&#10;                &lt;div class=&quot;label&quot;&gt;Average Temp&lt;/div&gt;&#10;                &lt;div class=&quot;value&quot;&gt;${data.avgTemp || data.averageTemperature || 'N/A'}°C&lt;/div&gt;&#10;            &lt;/div&gt;&#10;            &lt;div class=&quot;report-item&quot;&gt;&#10;                &lt;div class=&quot;label&quot;&gt;Min Temp&lt;/div&gt;&#10;                &lt;div class=&quot;value&quot;&gt;${data.minTemp || data.minTemperature || 'N/A'}°C&lt;/div&gt;&#10;            &lt;/div&gt;&#10;            &lt;div class=&quot;report-item&quot;&gt;&#10;                &lt;div class=&quot;label&quot;&gt;Max Temp&lt;/div&gt;&#10;                &lt;div class=&quot;value&quot;&gt;${data.maxTemp || data.maxTemperature || 'N/A'}°C&lt;/div&gt;&#10;            &lt;/div&gt;&#10;            &lt;div class=&quot;report-item&quot;&gt;&#10;                &lt;div class=&quot;label&quot;&gt;Records&lt;/div&gt;&#10;                &lt;div class=&quot;value&quot;&gt;${data.recordCount || data.count || 'N/A'}&lt;/div&gt;&#10;            &lt;/div&gt;&#10;        &lt;/div&gt;&#10;    `;&#10;&#10;        resultDiv.classList.remove('hidden');&#10;    }&#10;&lt;/script&gt;&#10;&lt;/body&gt;&#10;&lt;/html&gt;" />
              <option name="updatedContent" value="&lt;!DOCTYPE html&gt;&#10;&lt;html lang=&quot;en&quot;&gt;&#10;&lt;head&gt;&#10;    &lt;meta charset=&quot;UTF-8&quot;&gt;&#10;    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;&#10;    &lt;title&gt;Weather System&lt;/title&gt;&#10;    &lt;style&gt;&#10;        * {&#10;            margin: 0;&#10;            padding: 0;&#10;            box-sizing: border-box;&#10;        }&#10;&#10;        body {&#10;            font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', 'Segoe UI', sans-serif;&#10;            background: linear-gradient(135deg, #e0f2fe 0%, #fef3c7 100%);&#10;            min-height: 100vh;&#10;            padding: 60px 20px;&#10;            color: #1e293b;&#10;        }&#10;&#10;        .container {&#10;            max-width: 1200px;&#10;            margin: 0 auto;&#10;        }&#10;&#10;        .header {&#10;            text-align: center;&#10;            margin-bottom: 60px;&#10;        }&#10;&#10;        .header h1 {&#10;            font-size: 52px;&#10;            font-weight: 700;&#10;            margin-bottom: 12px;&#10;            color: #0f172a;&#10;            letter-spacing: -1px;&#10;            text-shadow: 0 2px 4px rgba(0,0,0,0.05);&#10;        }&#10;&#10;        .header .subtitle {&#10;            font-size: 18px;&#10;            color: #64748b;&#10;            font-weight: 400;&#10;        }&#10;&#10;        .section {&#10;            background: rgba(255, 255, 255, 0.95);&#10;            backdrop-filter: blur(10px);&#10;            border-radius: 16px;&#10;            padding: 40px;&#10;            margin-bottom: 24px;&#10;            box-shadow: 0 4px 20px rgba(0,0,0,0.08);&#10;            border: 1px solid rgba(255,255,255,0.8);&#10;        }&#10;&#10;        .section-title {&#10;            font-size: 24px;&#10;            font-weight: 700;&#10;            margin-bottom: 28px;&#10;            color: #0f172a;&#10;            display: flex;&#10;            align-items: center;&#10;            gap: 10px;&#10;        }&#10;&#10;        .form-group {&#10;            margin-bottom: 20px;&#10;        }&#10;&#10;        label {&#10;            display: block;&#10;            font-size: 14px;&#10;            font-weight: 600;&#10;            margin-bottom: 8px;&#10;            color: #475569;&#10;        }&#10;&#10;        input, select {&#10;            width: 100%;&#10;            padding: 14px 16px;&#10;            font-size: 16px;&#10;            border: 2px solid #e2e8f0;&#10;            border-radius: 10px;&#10;            outline: none;&#10;            transition: all 0.2s;&#10;            background: white;&#10;        }&#10;&#10;        input:focus, select:focus {&#10;            border-color: #3b82f6;&#10;            box-shadow: 0 0 0 4px rgba(59, 130, 246, 0.1);&#10;        }&#10;&#10;        .form-row {&#10;            display: grid;&#10;            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));&#10;            gap: 16px;&#10;        }&#10;&#10;        button {&#10;            padding: 14px 28px;&#10;            font-size: 16px;&#10;            font-weight: 600;&#10;            border: none;&#10;            border-radius: 10px;&#10;            cursor: pointer;&#10;            transition: all 0.25s;&#10;        }&#10;&#10;        .btn-primary {&#10;            background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);&#10;            color: white;&#10;        }&#10;&#10;        .btn-primary:hover {&#10;            transform: translateY(-2px);&#10;            box-shadow: 0 8px 20px rgba(59, 130, 246, 0.4);&#10;        }&#10;&#10;        .btn-success {&#10;            background: linear-gradient(135deg, #10b981 0%, #059669 100%);&#10;            color: white;&#10;        }&#10;&#10;        .btn-success:hover {&#10;            transform: translateY(-2px);&#10;            box-shadow: 0 8px 20px rgba(16, 185, 129, 0.4);&#10;        }&#10;&#10;        .btn-edit {&#10;            background: #f1f5f9;&#10;            color: #475569;&#10;            padding: 10px 18px;&#10;            font-size: 14px;&#10;            margin-right: 6px;&#10;        }&#10;&#10;        .btn-edit:hover {&#10;            background: #e2e8f0;&#10;        }&#10;&#10;        .btn-warning {&#10;            background: #fbbf24;&#10;            color: white;&#10;            padding: 10px 18px;&#10;            font-size: 14px;&#10;        }&#10;&#10;        .btn-warning:hover {&#10;            background: #f59e0b;&#10;        }&#10;&#10;        .btn-danger {&#10;            background: #ef4444;&#10;            color: white;&#10;            padding: 10px 18px;&#10;            font-size: 14px;&#10;        }&#10;&#10;        .btn-danger:hover {&#10;            background: #dc2626;&#10;        }&#10;&#10;        table {&#10;            width: 100%;&#10;            border-collapse: collapse;&#10;            margin-top: 28px;&#10;        }&#10;&#10;        th {&#10;            text-align: left;&#10;            padding: 14px;&#10;            background: #f8fafc;&#10;            font-weight: 700;&#10;            font-size: 13px;&#10;            color: #64748b;&#10;            border-bottom: 2px solid #e2e8f0;&#10;        }&#10;&#10;        td {&#10;            padding: 16px 14px;&#10;            border-bottom: 1px solid #f1f5f9;&#10;            font-size: 15px;&#10;        }&#10;&#10;        tr:hover {&#10;            background: #fafafa;&#10;        }&#10;&#10;        .alert-badge {&#10;            display: inline-block;&#10;            padding: 6px 14px;&#10;            border-radius: 8px;&#10;            font-size: 12px;&#10;            font-weight: 700;&#10;            color: white;&#10;        }&#10;&#10;        .color-preview {&#10;            display: inline-block;&#10;            width: 28px;&#10;            height: 28px;&#10;            border-radius: 6px;&#10;            border: 2px solid #e2e8f0;&#10;            vertical-align: middle;&#10;        }&#10;&#10;        /* BEAUTIFUL WEATHER CARD */&#10;        .weather-card {&#10;            background: linear-gradient(135deg, #60a5fa 0%, #3b82f6 100%);&#10;            padding: 56px 40px;&#10;            border-radius: 16px;&#10;            text-align: center;&#10;            margin-top: 28px;&#10;            box-shadow: 0 10px 30px rgba(59, 130, 246, 0.3);&#10;            color: white;&#10;        }&#10;&#10;        .weather-city {&#10;            font-size: 24px;&#10;            font-weight: 600;&#10;            margin-bottom: 16px;&#10;            opacity: 0.95;&#10;        }&#10;&#10;        .weather-temp {&#10;            font-size: 76px;&#10;            font-weight: 200;&#10;            margin-bottom: 12px;&#10;            letter-spacing: -3px;&#10;        }&#10;&#10;        .weather-desc {&#10;            font-size: 20px;&#10;            margin-bottom: 24px;&#10;            opacity: 0.95;&#10;        }&#10;&#10;        .weather-status {&#10;            display: inline-block;&#10;            padding: 10px 24px;&#10;            background: rgba(255,255,255,0.25);&#10;            backdrop-filter: blur(10px);&#10;            border-radius: 12px;&#10;            font-size: 14px;&#10;            font-weight: 700;&#10;        }&#10;&#10;        /* ALERT MESSAGE BOX */&#10;        .alert-message-box {&#10;            margin-top: 28px;&#10;            padding: 24px;&#10;            border-radius: 12px;&#10;            display: flex;&#10;            align-items: center;&#10;            gap: 20px;&#10;            background: rgba(255,255,255,0.2);&#10;            backdrop-filter: blur(10px);&#10;            border: 1px solid rgba(255,255,255,0.3);&#10;        }&#10;&#10;        .alert-icon {&#10;            font-size: 32px;&#10;        }&#10;&#10;        .alert-content {&#10;            flex: 1;&#10;            text-align: left;&#10;        }&#10;&#10;        .alert-title {&#10;            font-size: 18px;&#10;            font-weight: 700;&#10;            margin-bottom: 6px;&#10;        }&#10;&#10;        .alert-text {&#10;            font-size: 16px;&#10;            opacity: 0.95;&#10;        }&#10;&#10;        .report-grid {&#10;            display: grid;&#10;            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));&#10;            gap: 20px;&#10;            margin-top: 28px;&#10;        }&#10;&#10;        .report-item {&#10;            background: #f8fafc;&#10;            padding: 32px 24px;&#10;            border-radius: 12px;&#10;            text-align: center;&#10;            border: 1px solid #e2e8f0;&#10;        }&#10;&#10;        .report-item .label {&#10;            font-size: 13px;&#10;            color: #64748b;&#10;            margin-bottom: 12px;&#10;            font-weight: 600;&#10;        }&#10;&#10;        .report-item .value {&#10;            font-size: 32px;&#10;            font-weight: 700;&#10;            color: #0f172a;&#10;        }&#10;&#10;        .empty-state {&#10;            text-align: center;&#10;            padding: 60px 20px;&#10;            color: #94a3b8;&#10;            font-size: 16px;&#10;        }&#10;&#10;        .toast {&#10;            position: fixed;&#10;            top: 24px;&#10;            right: 24px;&#10;            background: #0f172a;&#10;            color: white;&#10;            padding: 16px 24px;&#10;            border-radius: 12px;&#10;            box-shadow: 0 10px 40px rgba(0,0,0,0.3);&#10;            display: none;&#10;            animation: slideIn 0.3s ease;&#10;            z-index: 1000;&#10;            font-weight: 600;&#10;        }&#10;&#10;        .toast.error {&#10;            background: #ef4444;&#10;        }&#10;&#10;        @keyframes slideIn {&#10;            from {&#10;                transform: translateX(100%);&#10;                opacity: 0;&#10;            }&#10;            to {&#10;                transform: translateX(0);&#10;                opacity: 1;&#10;            }&#10;        }&#10;&#10;        @keyframes pulse {&#10;            0%, 100% {&#10;                opacity: 1;&#10;            }&#10;            50% {&#10;                opacity: 0.5;&#10;            }&#10;        }&#10;&#10;        .loading {&#10;            display: none;&#10;            text-align: center;&#10;            padding: 28px;&#10;            color: #3b82f6;&#10;            font-weight: 600;&#10;            font-size: 16px;&#10;        }&#10;&#10;        .hidden {&#10;            display: none;&#10;        }&#10;&#10;        /* Modal */&#10;        .modal {&#10;            display: none;&#10;            position: fixed;&#10;            top: 0;&#10;            left: 0;&#10;            width: 100%;&#10;            height: 100%;&#10;            background: rgba(15, 23, 42, 0.6);&#10;            backdrop-filter: blur(8px);&#10;            z-index: 1000;&#10;            align-items: center;&#10;            justify-content: center;&#10;        }&#10;&#10;        .modal.show {&#10;            display: flex;&#10;        }&#10;&#10;        .modal-content {&#10;            background: white;&#10;            border-radius: 16px;&#10;            padding: 40px;&#10;            max-width: 540px;&#10;            width: 90%;&#10;            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);&#10;        }&#10;&#10;        .modal-title {&#10;            font-size: 26px;&#10;            font-weight: 700;&#10;            margin-bottom: 28px;&#10;            color: #0f172a;&#10;        }&#10;&#10;        .modal-actions {&#10;            display: flex;&#10;            gap: 12px;&#10;            margin-top: 28px;&#10;            justify-content: flex-end;&#10;        }&#10;&#10;        .btn-cancel {&#10;            background: #f1f5f9;&#10;            color: #475569;&#10;            padding: 14px 28px;&#10;            font-size: 16px;&#10;            font-weight: 600;&#10;            border: none;&#10;            border-radius: 10px;&#10;            cursor: pointer;&#10;        }&#10;&#10;        .btn-cancel:hover {&#10;            background: #e2e8f0;&#10;        }&#10;&#10;        /* Compact Section */&#10;        .compact-section {&#10;            padding: 28px 40px;&#10;        }&#10;&#10;        .compact-section .section-title {&#10;            font-size: 20px;&#10;            margin-bottom: 16px;&#10;        }&#10;&#10;        .compact-section p {&#10;            font-size: 14px;&#10;            color: #64748b;&#10;            margin-bottom: 16px;&#10;            line-height: 1.6;&#10;        }&#10;    &lt;/style&gt;&#10;&lt;/head&gt;&#10;&lt;body&gt;&#10;&#10;&lt;div class=&quot;toast&quot; id=&quot;toast&quot;&gt;&lt;/div&gt;&#10;&#10;&lt;!-- Edit Modal --&gt;&#10;&lt;div class=&quot;modal&quot; id=&quot;editModal&quot;&gt;&#10;    &lt;div class=&quot;modal-content&quot;&gt;&#10;        &lt;div class=&quot;modal-title&quot;&gt;Edit Alert Rule&lt;/div&gt;&#10;        &lt;form id=&quot;editForm&quot; onsubmit=&quot;saveEdit(event)&quot;&gt;&#10;            &lt;input type=&quot;hidden&quot; id=&quot;editId&quot;&gt;&#10;            &lt;div class=&quot;form-row&quot;&gt;&#10;                &lt;div class=&quot;form-group&quot;&gt;&#10;                    &lt;label&gt;Alert Type&lt;/label&gt;&#10;                    &lt;select id=&quot;editAlertType&quot; required&gt;&#10;                        &lt;option value=&quot;TEMPERATURE&quot;&gt;Temperature&lt;/option&gt;&#10;                        &lt;option value=&quot;HUMIDITY&quot;&gt;Humidity&lt;/option&gt;&#10;                        &lt;option value=&quot;WIND&quot;&gt;Wind Speed&lt;/option&gt;&#10;                    &lt;/select&gt;&#10;                &lt;/div&gt;&#10;                &lt;div class=&quot;form-group&quot;&gt;&#10;                    &lt;label&gt;Condition&lt;/label&gt;&#10;                    &lt;div style=&quot;display: flex; gap: 8px;&quot;&gt;&#10;                        &lt;select id=&quot;editOperator&quot; required style=&quot;width: 80px;&quot;&gt;&#10;                            &lt;option value=&quot;&gt;&quot;&gt;&gt;&lt;/option&gt;&#10;                            &lt;option value=&quot;&lt;&quot;&gt;&lt;&lt;/option&gt;&#10;                            &lt;option value=&quot;&gt;=&quot;&gt;&gt;=&lt;/option&gt;&#10;                            &lt;option value=&quot;&lt;=&quot;&gt;&lt;=&lt;/option&gt;&#10;                        &lt;/select&gt;&#10;                        &lt;input type=&quot;number&quot; step=&quot;0.1&quot; id=&quot;editThreshold&quot; required style=&quot;flex: 1;&quot;&gt;&#10;                    &lt;/div&gt;&#10;                &lt;/div&gt;&#10;            &lt;/div&gt;&#10;            &lt;div class=&quot;form-row&quot;&gt;&#10;                &lt;div class=&quot;form-group&quot;&gt;&#10;                    &lt;label&gt;Severity&lt;/label&gt;&#10;                    &lt;select id=&quot;editSeverity&quot; required&gt;&#10;                        &lt;option value=&quot;LOW&quot;&gt;Low&lt;/option&gt;&#10;                        &lt;option value=&quot;MEDIUM&quot;&gt;Medium&lt;/option&gt;&#10;                        &lt;option value=&quot;HIGH&quot;&gt;High&lt;/option&gt;&#10;                        &lt;option value=&quot;EXTREME&quot;&gt;Extreme&lt;/option&gt;&#10;                    &lt;/select&gt;&#10;                &lt;/div&gt;&#10;                &lt;div class=&quot;form-group&quot;&gt;&#10;                    &lt;label&gt;Color&lt;/label&gt;&#10;                    &lt;input type=&quot;color&quot; id=&quot;editColor&quot; required&gt;&#10;                &lt;/div&gt;&#10;            &lt;/div&gt;&#10;            &lt;div class=&quot;form-group&quot;&gt;&#10;                &lt;label&gt;Alert Message&lt;/label&gt;&#10;                &lt;input type=&quot;text&quot; id=&quot;editMessage&quot; required&gt;&#10;            &lt;/div&gt;&#10;            &lt;div class=&quot;modal-actions&quot;&gt;&#10;                &lt;button type=&quot;button&quot; class=&quot;btn-cancel&quot; onclick=&quot;closeEditModal()&quot;&gt;Cancel&lt;/button&gt;&#10;                &lt;button type=&quot;submit&quot; class=&quot;btn-primary&quot;&gt;Save Changes&lt;/button&gt;&#10;            &lt;/div&gt;&#10;        &lt;/form&gt;&#10;    &lt;/div&gt;&#10;&lt;/div&gt;&#10;&#10;&lt;div class=&quot;container&quot;&gt;&#10;    &lt;div class=&quot;header&quot;&gt;&#10;        &lt;h1&gt;⛅ Weather System&lt;/h1&gt;&#10;        &lt;p class=&quot;subtitle&quot;&gt;Distributed Microservices Architecture&lt;/p&gt;&#10;    &lt;/div&gt;&#10;&#10;    &lt;!-- Alert Rules Manager --&gt;&#10;    &lt;div class=&quot;section&quot;&gt;&#10;        &lt;div class=&quot;section-title&quot;&gt;⚡ Alert Rules Manager&lt;/div&gt;&#10;        &lt;form id=&quot;alertForm&quot; onsubmit=&quot;addAlert(event)&quot;&gt;&#10;            &lt;div class=&quot;form-row&quot;&gt;&#10;                &lt;div class=&quot;form-group&quot;&gt;&#10;                    &lt;label&gt;Alert Type&lt;/label&gt;&#10;                    &lt;select id=&quot;alertType&quot; required&gt;&#10;                        &lt;option value=&quot;TEMPERATURE&quot;&gt;Temperature&lt;/option&gt;&#10;                        &lt;option value=&quot;HUMIDITY&quot;&gt;Humidity&lt;/option&gt;&#10;                        &lt;option value=&quot;WIND&quot;&gt;Wind Speed&lt;/option&gt;&#10;                    &lt;/select&gt;&#10;                &lt;/div&gt;&#10;                &lt;div class=&quot;form-group&quot;&gt;&#10;                    &lt;label&gt;Condition&lt;/label&gt;&#10;                    &lt;div style=&quot;display: flex; gap: 8px;&quot;&gt;&#10;                        &lt;select id=&quot;operator&quot; required style=&quot;width: 80px;&quot;&gt;&#10;                            &lt;option value=&quot;&gt;&quot;&gt;&gt;&lt;/option&gt;&#10;                            &lt;option value=&quot;&lt;&quot;&gt;&lt;&lt;/option&gt;&#10;                            &lt;option value=&quot;&gt;=&quot;&gt;&gt;=&lt;/option&gt;&#10;                            &lt;option value=&quot;&lt;=&quot;&gt;&lt;=&lt;/option&gt;&#10;                        &lt;/select&gt;&#10;                        &lt;input type=&quot;number&quot; step=&quot;0.1&quot; id=&quot;threshold&quot; required placeholder=&quot;30&quot; style=&quot;flex: 1;&quot;&gt;&#10;                    &lt;/div&gt;&#10;                &lt;/div&gt;&#10;                &lt;div class=&quot;form-group&quot;&gt;&#10;                    &lt;label&gt;Severity&lt;/label&gt;&#10;                    &lt;select id=&quot;severity&quot; required&gt;&#10;                        &lt;option value=&quot;LOW&quot;&gt;Low&lt;/option&gt;&#10;                        &lt;option value=&quot;MEDIUM&quot;&gt;Medium&lt;/option&gt;&#10;                        &lt;option value=&quot;HIGH&quot;&gt;High&lt;/option&gt;&#10;                        &lt;option value=&quot;EXTREME&quot;&gt;Extreme&lt;/option&gt;&#10;                    &lt;/select&gt;&#10;                &lt;/div&gt;&#10;                &lt;div class=&quot;form-group&quot;&gt;&#10;                    &lt;label&gt;Color&lt;/label&gt;&#10;                    &lt;input type=&quot;color&quot; id=&quot;color&quot; required value=&quot;#667eea&quot;&gt;&#10;                &lt;/div&gt;&#10;            &lt;/div&gt;&#10;            &lt;div class=&quot;form-group&quot;&gt;&#10;                &lt;label&gt;Alert Message&lt;/label&gt;&#10;                &lt;input type=&quot;text&quot; id=&quot;message&quot; required placeholder=&quot;Temperature alert!&quot;&gt;&#10;            &lt;/div&gt;&#10;            &lt;button type=&quot;submit&quot; class=&quot;btn-primary&quot;&gt;Add Alert Rule&lt;/button&gt;&#10;        &lt;/form&gt;&#10;&#10;        &lt;table id=&quot;alertsTable&quot;&gt;&#10;            &lt;thead&gt;&#10;            &lt;tr&gt;&#10;                &lt;th&gt;ID&lt;/th&gt;&#10;                &lt;th&gt;Type&lt;/th&gt;&#10;                &lt;th&gt;Condition&lt;/th&gt;&#10;                &lt;th&gt;Severity&lt;/th&gt;&#10;                &lt;th&gt;Color&lt;/th&gt;&#10;                &lt;th&gt;Message&lt;/th&gt;&#10;                &lt;th&gt;Status&lt;/th&gt;&#10;                &lt;th&gt;Actions&lt;/th&gt;&#10;            &lt;/tr&gt;&#10;            &lt;/thead&gt;&#10;            &lt;tbody id=&quot;alertsBody&quot;&gt;&#10;            &lt;tr&gt;&lt;td colspan=&quot;8&quot; class=&quot;empty-state&quot;&gt;Loading...&lt;/td&gt;&lt;/tr&gt;&#10;            &lt;/tbody&gt;&#10;        &lt;/table&gt;&#10;    &lt;/div&gt;&#10;&#10;    &lt;!-- Live Weather --&gt;&#10;    &lt;div class=&quot;section&quot;&gt;&#10;        &lt;div class=&quot;section-title&quot;&gt;️ Live Weather&lt;/div&gt;&#10;        &lt;div class=&quot;form-group&quot;&gt;&#10;            &lt;label&gt;City Name&lt;/label&gt;&#10;            &lt;input type=&quot;text&quot; id=&quot;grpcCity&quot; placeholder=&quot;Warsaw&quot;&gt;&#10;        &lt;/div&gt;&#10;        &lt;button class=&quot;btn-success&quot; onclick=&quot;getLiveWeather()&quot;&gt;Get Weather&lt;/button&gt;&#10;        &lt;div id=&quot;grpcLoading&quot; class=&quot;loading hidden&quot;&gt;Loading weather data...&lt;/div&gt;&#10;        &lt;div id=&quot;grpcResult&quot; class=&quot;hidden&quot;&gt;&lt;/div&gt;&#10;    &lt;/div&gt;&#10;&#10;    &lt;!-- ============================================ --&gt;&#10;    &lt;!-- DODAJ TĘ SEKCJĘ do index.html              --&gt;&#10;    &lt;!-- PO sekcji &quot;Live Weather&quot;                   --&gt;&#10;    &lt;!-- ============================================ --&gt;&#10;&#10;    &lt;!-- gRPC Server Streaming --&gt;&#10;    &lt;div class=&quot;section&quot;&gt;&#10;        &lt;div class=&quot;section-title&quot;&gt; gRPC Server Streaming - Live Updates&lt;/div&gt;&#10;        &lt;p style=&quot;color: #64748b; margin-bottom: 20px; font-size: 14px;&quot;&gt;&#10;            Real-time weather updates via gRPC server streaming • Multiple onNext() calls • Live data from OpenWeatherMap&#10;        &lt;/p&gt;&#10;&#10;        &lt;div class=&quot;form-row&quot;&gt;&#10;            &lt;div class=&quot;form-group&quot;&gt;&#10;                &lt;label&gt;City Name&lt;/label&gt;&#10;                &lt;input type=&quot;text&quot; id=&quot;streamCity&quot; placeholder=&quot;Warsaw&quot; value=&quot;Warsaw&quot;&gt;&#10;            &lt;/div&gt;&#10;            &lt;div class=&quot;form-group&quot;&gt;&#10;                &lt;label&gt;Number of Updates&lt;/label&gt;&#10;                &lt;input type=&quot;number&quot; id=&quot;streamUpdates&quot; placeholder=&quot;10&quot; value=&quot;10&quot; min=&quot;1&quot; max=&quot;20&quot;&gt;&#10;            &lt;/div&gt;&#10;            &lt;div class=&quot;form-group&quot;&gt;&#10;                &lt;label&gt;Interval (seconds)&lt;/label&gt;&#10;                &lt;input type=&quot;number&quot; id=&quot;streamInterval&quot; placeholder=&quot;5&quot; value=&quot;5&quot; min=&quot;2&quot; max=&quot;10&quot;&gt;&#10;            &lt;/div&gt;&#10;        &lt;/div&gt;&#10;&#10;        &lt;button class=&quot;btn-success&quot; onclick=&quot;startWeatherStream()&quot; id=&quot;streamButton&quot;&gt;&#10;             Start Live Stream&#10;        &lt;/button&gt;&#10;&#10;        &lt;div id=&quot;streamStatus&quot; style=&quot;margin-top: 20px; padding: 16px; border-radius: 8px; display: none;&quot;&gt;&lt;/div&gt;&#10;        &lt;div id=&quot;streamResult&quot; class=&quot;hidden&quot;&gt;&lt;/div&gt;&#10;    &lt;/div&gt;&#10;&#10;    &lt;script&gt;&#10;        // ============================================&#10;        // gRPC Streaming Function&#10;        // ============================================&#10;&#10;        let streamInProgress = false;&#10;        let currentEventSource = null;&#10;&#10;        async function startWeatherStream() {&#10;            if (streamInProgress) {&#10;                showToast('Stream already in progress!', 'error');&#10;                return;&#10;            }&#10;&#10;            const city = document.getElementById('streamCity').value.trim();&#10;            const updates = document.getElementById('streamUpdates').value;&#10;            const interval = document.getElementById('streamInterval').value;&#10;&#10;            if (!city) {&#10;                showToast('Enter a city name', 'error');&#10;                return;&#10;            }&#10;&#10;            const statusDiv = document.getElementById('streamStatus');&#10;            const resultDiv = document.getElementById('streamResult');&#10;            const button = document.getElementById('streamButton');&#10;&#10;            // Disable button&#10;            streamInProgress = true;&#10;            button.disabled = true;&#10;            button.style.opacity = '0.5';&#10;            button.textContent = '⏳ Streaming...';&#10;&#10;            // Show status&#10;            statusDiv.style.display = 'block';&#10;            statusDiv.style.background = 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)';&#10;            statusDiv.style.color = 'white';&#10;            statusDiv.innerHTML = `&#10;        &lt;div style=&quot;font-weight: 600; font-size: 16px; margin-bottom: 8px;&quot;&gt;&#10;             Live Weather Stream Started&#10;        &lt;/div&gt;&#10;        &lt;div style=&quot;font-size: 14px; opacity: 0.9;&quot;&gt;&#10;            City: ${city} | Updates: ${updates} | Interval: ${interval}s&#10;        &lt;/div&gt;&#10;        &lt;div style=&quot;margin-top: 12px; font-size: 13px;&quot;&gt;&#10;            ⏳ Fetching updates from OpenWeatherMap API in real-time...&#10;        &lt;/div&gt;&#10;    `;&#10;&#10;            // Create table with empty body&#10;            resultDiv.innerHTML = `&#10;        &lt;table style=&quot;margin-top: 20px;&quot;&gt;&#10;            &lt;thead&gt;&#10;                &lt;tr&gt;&#10;                    &lt;th&gt;#&lt;/th&gt;&#10;                    &lt;th&gt;City&lt;/th&gt;&#10;                    &lt;th&gt;Temperature&lt;/th&gt;&#10;                    &lt;th&gt;Description&lt;/th&gt;&#10;                    &lt;th&gt;Time&lt;/th&gt;&#10;                &lt;/tr&gt;&#10;            &lt;/thead&gt;&#10;            &lt;tbody id=&quot;streamTableBody&quot;&gt;&#10;                &lt;tr&gt;&#10;                    &lt;td colspan=&quot;5&quot; style=&quot;text-align: center; color: #64748b;&quot;&gt;&#10;                        ⏳ Waiting for first update...&#10;                    &lt;/td&gt;&#10;                &lt;/tr&gt;&#10;            &lt;/tbody&gt;&#10;        &lt;/table&gt;&#10;    `;&#10;            resultDiv.classList.remove('hidden');&#10;&#10;            const startTime = Date.now();&#10;            let updateCount = 0;&#10;&#10;            // Use Server-Sent Events (SSE) for real-time streaming!&#10;            const eventSource = new EventSource(&#10;                `http://localhost:8085/api/weather/stream-sse/${city}?updates=${updates}&amp;intervalSeconds=${interval}`&#10;            );&#10;            currentEventSource = eventSource;&#10;&#10;            // Listen for weather updates&#10;            eventSource.addEventListener('weather-update', (event) =&gt; {&#10;                const update = JSON.parse(event.data);&#10;                updateCount++;&#10;&#10;                console.log(' Received update:', update);&#10;&#10;                // Add row to table in real-time!&#10;                addStreamUpdateRow(update);&#10;&#10;                // Update status with current progress&#10;                const elapsed = ((Date.now() - startTime) / 1000).toFixed(1);&#10;                statusDiv.innerHTML = `&#10;            &lt;div style=&quot;font-weight: 600; font-size: 16px; margin-bottom: 8px;&quot;&gt;&#10;                 Streaming... (${updateCount}/${updates})&#10;            &lt;/div&gt;&#10;            &lt;div style=&quot;font-size: 14px; opacity: 0.9;&quot;&gt;&#10;                City: ${city} | Elapsed: ${elapsed}s&#10;            &lt;/div&gt;&#10;            &lt;div style=&quot;margin-top: 12px; font-size: 13px; animation: pulse 2s infinite;&quot;&gt;&#10;                 Receiving live updates...&#10;            &lt;/div&gt;&#10;        `;&#10;            });&#10;&#10;            // Stream completed&#10;            eventSource.addEventListener('error', (event) =&gt; {&#10;                console.log('Stream ended or error occurred');&#10;                eventSource.close();&#10;                currentEventSource = null;&#10;&#10;                const elapsed = ((Date.now() - startTime) / 1000).toFixed(1);&#10;&#10;                statusDiv.style.background = 'linear-gradient(135deg, #10b981 0%, #059669 100%)';&#10;                statusDiv.innerHTML = `&#10;            &lt;div style=&quot;font-weight: 600; font-size: 16px; margin-bottom: 8px;&quot;&gt;&#10;                ✅ Stream Completed Successfully!&#10;            &lt;/div&gt;&#10;            &lt;div style=&quot;font-size: 14px;&quot;&gt;&#10;                Received ${updateCount} updates in ${elapsed}s&#10;            &lt;/div&gt;&#10;        `;&#10;&#10;                showToast(`✅ Stream completed! ${updateCount} updates received`);&#10;&#10;                // Re-enable button&#10;                streamInProgress = false;&#10;                button.disabled = false;&#10;                button.style.opacity = '1';&#10;                button.textContent = ' Start Live Stream';&#10;            });&#10;        }&#10;&#10;        function addStreamUpdateRow(update) {&#10;            const tbody = document.getElementById('streamTableBody');&#10;&#10;            // Remove &quot;waiting&quot; message if it exists&#10;            if (tbody.querySelector('td[colspan=&quot;5&quot;]')) {&#10;                tbody.innerHTML = '';&#10;            }&#10;&#10;            // Create new row (no animation - just appears)&#10;            const row = document.createElement('tr');&#10;            row.innerHTML = `&#10;        &lt;td style=&quot;font-weight: 700; color: #3b82f6;&quot;&gt;#${update.updateNumber}&lt;/td&gt;&#10;        &lt;td&gt;${update.city}&lt;/td&gt;&#10;        &lt;td style=&quot;font-weight: 700; color: #10b981;&quot;&gt;${update.temperature.toFixed(1)}°C&lt;/td&gt;&#10;        &lt;td&gt;${update.description}&lt;/td&gt;&#10;        &lt;td style=&quot;color: #64748b; font-size: 13px;&quot;&gt;${new Date(update.timestamp).toLocaleTimeString()}&lt;/td&gt;&#10;    `;&#10;&#10;            // Add to table (newest at bottom)&#10;            tbody.appendChild(row);&#10;&#10;            // Scroll to bottom to show newest update&#10;            row.scrollIntoView({ behavior: 'smooth', block: 'nearest' });&#10;        }&#10;&#10;        function displayStreamUpdates(updates) {&#10;            const tbody = document.getElementById('streamTableBody');&#10;&#10;            if (!updates || updates.length === 0) {&#10;                tbody.innerHTML = `&#10;            &lt;tr&gt;&#10;                &lt;td colspan=&quot;5&quot; class=&quot;empty-state&quot;&gt;No updates received&lt;/td&gt;&#10;            &lt;/tr&gt;&#10;        `;&#10;                return;&#10;            }&#10;&#10;            tbody.innerHTML = updates.map(update =&gt; `&#10;        &lt;tr&gt;&#10;            &lt;td style=&quot;font-weight: 700; color: #3b82f6;&quot;&gt;#${update.updateNumber}&lt;/td&gt;&#10;            &lt;td&gt;${update.city}&lt;/td&gt;&#10;            &lt;td style=&quot;font-weight: 700; color: #10b981;&quot;&gt;${update.temperature.toFixed(1)}°C&lt;/td&gt;&#10;            &lt;td&gt;${update.description}&lt;/td&gt;&#10;            &lt;td style=&quot;color: #64748b; font-size: 13px;&quot;&gt;${update.timestamp}&lt;/td&gt;&#10;        &lt;/tr&gt;&#10;    `).join('');&#10;        }&#10;    &lt;/script&gt;&#10;&#10;    &lt;!-- Async gRPC (Compact) --&gt;&#10;    &lt;div class=&quot;section compact-section&quot;&gt;&#10;        &lt;div class=&quot;section-title&quot;&gt; Async gRPC Demo&lt;/div&gt;&#10;        &lt;p&gt;Non-blocking call with StreamObserver. Server responds immediately.&lt;/p&gt;&#10;        &lt;div class=&quot;form-group&quot;&gt;&#10;            &lt;input type=&quot;text&quot; id=&quot;asyncCity&quot; placeholder=&quot;City name&quot; style=&quot;margin-bottom: 12px;&quot;&gt;&#10;        &lt;/div&gt;&#10;        &lt;button class=&quot;btn-primary&quot; onclick=&quot;testAsyncGrpc()&quot;&gt;Test Async&lt;/button&gt;&#10;        &lt;div id=&quot;asyncLoading&quot; class=&quot;loading hidden&quot;&gt;Calling...&lt;/div&gt;&#10;        &lt;div id=&quot;asyncResult&quot; class=&quot;hidden&quot;&gt;&lt;/div&gt;&#10;    &lt;/div&gt;&#10;&#10;    &lt;!-- SOAP Report --&gt;&#10;    &lt;div class=&quot;section&quot;&gt;&#10;        &lt;div class=&quot;section-title&quot;&gt; Weather Report (SOAP)&lt;/div&gt;&#10;        &lt;div class=&quot;form-group&quot;&gt;&#10;            &lt;label&gt;City Name&lt;/label&gt;&#10;            &lt;input type=&quot;text&quot; id=&quot;soapCity&quot; placeholder=&quot;Warsaw&quot;&gt;&#10;        &lt;/div&gt;&#10;        &lt;button class=&quot;btn-success&quot; onclick=&quot;generateReport()&quot;&gt;Generate Report&lt;/button&gt;&#10;        &lt;div id=&quot;soapLoading&quot; class=&quot;loading hidden&quot;&gt;Generating report...&lt;/div&gt;&#10;        &lt;div id=&quot;soapResult&quot; class=&quot;hidden&quot;&gt;&lt;/div&gt;&#10;    &lt;/div&gt;&#10;&#10;    &lt;!-- Historical Data --&gt;&#10;    &lt;div class=&quot;section&quot;&gt;&#10;        &lt;div class=&quot;section-title&quot;&gt; Historical Data (XML-RPC)&lt;/div&gt;&#10;        &lt;div class=&quot;form-group&quot;&gt;&#10;            &lt;label&gt;City Name&lt;/label&gt;&#10;            &lt;input type=&quot;text&quot; id=&quot;xmlrpcCity&quot; placeholder=&quot;Warsaw&quot;&gt;&#10;        &lt;/div&gt;&#10;        &lt;button class=&quot;btn-success&quot; onclick=&quot;getHistoricalWeather()&quot;&gt;Get History&lt;/button&gt;&#10;        &lt;div id=&quot;xmlrpcLoading&quot; class=&quot;loading hidden&quot;&gt;Loading history...&lt;/div&gt;&#10;        &lt;div id=&quot;xmlrpcResult&quot; class=&quot;hidden&quot;&gt;&lt;/div&gt;&#10;    &lt;/div&gt;&#10;&lt;/div&gt;&#10;&#10;&lt;script&gt;&#10;    const ALERTS_API = 'http://localhost:8084/api/alert-rules';&#10;    const GRPC_API = 'http://localhost:8085/api/weather';&#10;    const SOAP_API = 'http://localhost:8085/api/report';&#10;    const XMLRPC_API = 'http://localhost:8088/xmlrpc/historical';&#10;&#10;    let triggeredAlert = null; // Store alert info globally&#10;    let alertsWithLinks = {}; // Store HATEOAS links for each alert&#10;&#10;    window.onload = () =&gt; {&#10;        loadAlerts();&#10;    };&#10;&#10;    // ALERTS CRUD&#10;    async function loadAlerts() {&#10;        try {&#10;            const response = await fetch(`${ALERTS_API}?page=0&amp;size=20&amp;sortBy=createdAt`);&#10;            const data = await response.json();&#10;&#10;            // Store alerts with their HATEOAS links&#10;            alertsWithLinks = {};&#10;            data.content.forEach(alert =&gt; {&#10;                // Handle both formats: _links (object) and links (array)&#10;                if (alert._links) {&#10;                    alertsWithLinks[alert.id] = alert._links;&#10;                } else if (alert.links &amp;&amp; Array.isArray(alert.links)) {&#10;                    // Convert array format to object format&#10;                    const linksObj = {};&#10;                    alert.links.forEach(link =&gt; {&#10;                        linksObj[link.rel] = { href: link.href };&#10;                    });&#10;                    alertsWithLinks[alert.id] = linksObj;&#10;                }&#10;            });&#10;&#10;            console.log(' HATEOAS links loaded:', alertsWithLinks);&#10;            displayAlerts(data.content);&#10;        } catch (error) {&#10;            showToast('Failed to load alerts', 'error');&#10;        }&#10;    }&#10;&#10;    function displayAlerts(alerts) {&#10;        const tbody = document.getElementById('alertsBody');&#10;        if (alerts.length === 0) {&#10;            tbody.innerHTML = '&lt;tr&gt;&lt;td colspan=&quot;8&quot; class=&quot;empty-state&quot;&gt;No alerts yet&lt;/td&gt;&lt;/tr&gt;';&#10;            return;&#10;        }&#10;        tbody.innerHTML = alerts.map(alert =&gt; `&#10;            &lt;tr id=&quot;row-${alert.id}&quot;&gt;&#10;                &lt;td&gt;${alert.id}&lt;/td&gt;&#10;                &lt;td&gt;${alert.alertType}&lt;/td&gt;&#10;                &lt;td&gt;${alert.operator} ${alert.threshold}&lt;/td&gt;&#10;                &lt;td&gt;&lt;span class=&quot;alert-badge&quot; style=&quot;background:${getSeverityColor(alert.severity)}&quot;&gt;${alert.severity}&lt;/span&gt;&lt;/td&gt;&#10;                &lt;td&gt;&lt;span class=&quot;color-preview&quot; style=&quot;background:${alert.color}&quot;&gt;&lt;/span&gt;&lt;/td&gt;&#10;                &lt;td&gt;${alert.message}&lt;/td&gt;&#10;                &lt;td style=&quot;color:${alert.active ? '#48bb78' : '#a0aec0'};font-weight:600&quot;&gt;${alert.active ? 'Active' : 'Inactive'}&lt;/td&gt;&#10;                &lt;td&gt;&#10;                    &lt;button class=&quot;btn-edit&quot; onclick=&quot;editAlert(${alert.id})&quot;&gt;Edit&lt;/button&gt;&#10;                    &lt;button class=&quot;btn-warning&quot; onclick=&quot;toggleAlert(${alert.id})&quot;&gt;${alert.active ? 'Disable' : 'Enable'}&lt;/button&gt;&#10;                    &lt;button class=&quot;btn-danger&quot; onclick=&quot;deleteAlert(${alert.id})&quot;&gt;Delete&lt;/button&gt;&#10;                &lt;/td&gt;&#10;            &lt;/tr&gt;&#10;        `).join('');&#10;    }&#10;&#10;    function getSeverityColor(severity) {&#10;        const colors = {'LOW': '#48bb78', 'MEDIUM': '#ed8936', 'HIGH': '#f56565', 'EXTREME': '#9b2c2c'};&#10;        return colors[severity] || '#718096';&#10;    }&#10;&#10;    async function addAlert(event) {&#10;        event.preventDefault();&#10;        const data = {&#10;            alertType: document.getElementById('alertType').value,&#10;            threshold: parseFloat(document.getElementById('threshold').value),&#10;            operator: document.getElementById('operator').value,&#10;            severity: document.getElementById('severity').value,&#10;            color: document.getElementById('color').value,&#10;            message: document.getElementById('message').value,&#10;            active: true&#10;        };&#10;        try {&#10;            const response = await fetch(ALERTS_API, {&#10;                method: 'POST',&#10;                headers: {'Content-Type': 'application/json'},&#10;                body: JSON.stringify(data)&#10;            });&#10;            if (response.ok) {&#10;                showToast('Alert added!');&#10;                document.getElementById('alertForm').reset();&#10;                loadAlerts();&#10;            } else {&#10;                showToast('Failed to add alert', 'error');&#10;            }&#10;        } catch (error) {&#10;            showToast('Error: ' + error.message, 'error');&#10;        }&#10;    }&#10;&#10;    function editAlert(id) {&#10;        const row = document.getElementById(`row-${id}`);&#10;        const cells = row.cells;&#10;        document.getElementById('editId').value = id;&#10;        document.getElementById('editAlertType').value = cells[1].textContent;&#10;        const condition = cells[2].textContent.trim().split(' ');&#10;        document.getElementById('editOperator').value = condition[0];&#10;        document.getElementById('editThreshold').value = parseFloat(condition[1]);&#10;        document.getElementById('editSeverity').value = cells[3].textContent.trim();&#10;        document.getElementById('editColor').value = cells[4].querySelector('.color-preview').style.background;&#10;        document.getElementById('editMessage').value = cells[5].textContent;&#10;        document.getElementById('editModal').classList.add('show');&#10;    }&#10;&#10;    function closeEditModal() {&#10;        document.getElementById('editModal').classList.remove('show');&#10;    }&#10;&#10;    async function saveEdit(event) {&#10;        event.preventDefault();&#10;        const id = document.getElementById('editId').value;&#10;        const data = {&#10;            alertType: document.getElementById('editAlertType').value,&#10;            threshold: parseFloat(document.getElementById('editThreshold').value),&#10;            operator: document.getElementById('editOperator').value,&#10;            severity: document.getElementById('editSeverity').value,&#10;            color: document.getElementById('editColor').value,&#10;            message: document.getElementById('editMessage').value,&#10;            active: true&#10;        };&#10;        try {&#10;            // Use HATEOAS link if available, otherwise fallback to manual URL&#10;            const updateUrl = alertsWithLinks[id]?.update?.href || `${ALERTS_API}/${id}`;&#10;&#10;            const response = await fetch(updateUrl, {&#10;                method: 'PUT',&#10;                headers: {'Content-Type': 'application/json'},&#10;                body: JSON.stringify(data)&#10;            });&#10;            if (response.ok) {&#10;                showToast('✅ Alert updated using HATEOAS!');&#10;                closeEditModal();&#10;                loadAlerts();&#10;            } else {&#10;                showToast('Failed to update', 'error');&#10;            }&#10;        } catch (error) {&#10;            showToast('Error: ' + error.message, 'error');&#10;        }&#10;    }&#10;&#10;    async function toggleAlert(id) {&#10;        try {&#10;            // Use HATEOAS link if available, otherwise fallback to manual URL&#10;            const toggleUrl = alertsWithLinks[id]?.toggle?.href || `${ALERTS_API}/${id}/toggle`;&#10;&#10;            const response = await fetch(toggleUrl, {method: 'PATCH'});&#10;            if (response.ok) {&#10;                showToast('✅ Status toggled using HATEOAS!');&#10;                loadAlerts();&#10;            }&#10;        } catch (error) {&#10;            showToast('Error: ' + error.message, 'error');&#10;        }&#10;    }&#10;&#10;    async function deleteAlert(id) {&#10;        if (!confirm('Delete this alert?')) return;&#10;        try {&#10;            // Use HATEOAS link if available, otherwise fallback to manual URL&#10;            const deleteUrl = alertsWithLinks[id]?.delete?.href || `${ALERTS_API}/${id}`;&#10;&#10;            const response = await fetch(deleteUrl, {method: 'DELETE'});&#10;            if (response.ok) {&#10;                showToast('✅ Alert deleted using HATEOAS!');&#10;                loadAlerts();&#10;            }&#10;        } catch (error) {&#10;            showToast('Error: ' + error.message, 'error');&#10;        }&#10;    }&#10;&#10;    // LIVE WEATHER with ALERT MESSAGE&#10;    async function getLiveWeather() {&#10;        const city = document.getElementById('grpcCity').value.trim();&#10;        if (!city) {&#10;            showToast('Enter a city name', 'error');&#10;            return;&#10;        }&#10;&#10;        const loading = document.getElementById('grpcLoading');&#10;        const result = document.getElementById('grpcResult');&#10;        loading.classList.remove('hidden');&#10;        result.classList.add('hidden');&#10;&#10;        try {&#10;            // Get weather&#10;            const response = await fetch(`${GRPC_API}/${city}`);&#10;            const data = await response.json();&#10;&#10;            // Get active alerts to find triggered one&#10;            const alertsResponse = await fetch(`${ALERTS_API}?page=0&amp;size=100`);&#10;            const alertsData = await alertsResponse.json();&#10;&#10;            // Find matching alert&#10;            triggeredAlert = null;&#10;            if (data.status === 'ALERT') {&#10;                const activeAlerts = alertsData.content.filter(a =&gt; a.active &amp;&amp; a.alertType === 'TEMPERATURE');&#10;                for (let alert of activeAlerts) {&#10;                    if (eval(`${data.temperature} ${alert.operator} ${alert.threshold}`)) {&#10;                        triggeredAlert = alert;&#10;                        break;&#10;                    }&#10;                }&#10;            }&#10;&#10;            result.innerHTML = `&#10;                &lt;div class=&quot;weather-card&quot;&gt;&#10;                    &lt;div class=&quot;weather-card-content&quot;&gt;&#10;                        &lt;div class=&quot;weather-city&quot;&gt;${data.city}&lt;/div&gt;&#10;                        &lt;div class=&quot;weather-temp&quot;&gt;${data.temperature.toFixed(1)}°&lt;/div&gt;&#10;                        &lt;div class=&quot;weather-desc&quot;&gt;${data.description}&lt;/div&gt;&#10;                        &lt;div class=&quot;weather-status&quot;&gt;${data.status}&lt;/div&gt;&#10;                        ${triggeredAlert ? `&#10;                            &lt;div class=&quot;alert-message-box&quot; style=&quot;border-left: 4px solid ${triggeredAlert.color}&quot;&gt;&#10;                                &lt;div class=&quot;alert-icon&quot;&gt;⚠️&lt;/div&gt;&#10;                                &lt;div class=&quot;alert-content&quot;&gt;&#10;                                    &lt;div class=&quot;alert-title&quot;&gt;${triggeredAlert.severity} Alert&lt;/div&gt;&#10;                                    &lt;div class=&quot;alert-text&quot;&gt;${triggeredAlert.message}&lt;/div&gt;&#10;                                &lt;/div&gt;&#10;                            &lt;/div&gt;&#10;                        ` : ''}&#10;                    &lt;/div&gt;&#10;                &lt;/div&gt;&#10;            `;&#10;            result.classList.remove('hidden');&#10;        } catch (error) {&#10;            showToast('Failed to get weather', 'error');&#10;        } finally {&#10;            loading.classList.add('hidden');&#10;        }&#10;    }&#10;&#10;    // ASYNC gRPC (Compact)&#10;    async function testAsyncGrpc() {&#10;        const city = document.getElementById('asyncCity').value.trim();&#10;        if (!city) {&#10;            showToast('Enter a city', 'error');&#10;            return;&#10;        }&#10;        const loading = document.getElementById('asyncLoading');&#10;        const result = document.getElementById('asyncResult');&#10;        loading.classList.remove('hidden');&#10;        result.classList.add('hidden');&#10;        try {&#10;            const response = await fetch(`http://localhost:8085/api/weather/async/${city}`);&#10;            const data = await response.json();&#10;            result.innerHTML = `&#10;                &lt;div style=&quot;margin-top:16px;padding:16px;background:#f7fafc;border-radius:8px;text-align:center&quot;&gt;&#10;                    &lt;div style=&quot;font-weight:600;margin-bottom:8px&quot;&gt;✅ Response: ${data.responseTime}&lt;/div&gt;&#10;                    &lt;div style=&quot;font-size:13px;color:#718096&quot;&gt;${data.info}&lt;/div&gt;&#10;                &lt;/div&gt;&#10;            `;&#10;            result.classList.remove('hidden');&#10;        } catch (error) {&#10;            showToast('Async failed', 'error');&#10;        } finally {&#10;            loading.classList.add('hidden');&#10;        }&#10;    }&#10;&#10;    // SOAP REPORT&#10;    async function generateReport() {&#10;        const city = document.getElementById('soapCity').value.trim();&#10;        if (!city) {&#10;            showToast('Enter a city', 'error');&#10;            return;&#10;        }&#10;        const loading = document.getElementById('soapLoading');&#10;        const result = document.getElementById('soapResult');&#10;        loading.classList.remove('hidden');&#10;        result.classList.add('hidden');&#10;        try {&#10;            const response = await fetch(`${SOAP_API}/${city}?days=7`);&#10;            const data = await response.json();&#10;            result.innerHTML = `&#10;                &lt;div class=&quot;report-grid&quot;&gt;&#10;                    &lt;div class=&quot;report-item&quot;&gt;&lt;div class=&quot;label&quot;&gt;City&lt;/div&gt;&lt;div class=&quot;value&quot;&gt;${data.city}&lt;/div&gt;&lt;/div&gt;&#10;                    &lt;div class=&quot;report-item&quot;&gt;&lt;div class=&quot;label&quot;&gt;Avg Temp&lt;/div&gt;&lt;div class=&quot;value&quot;&gt;${data.avgTemp}°C&lt;/div&gt;&lt;/div&gt;&#10;                    &lt;div class=&quot;report-item&quot;&gt;&lt;div class=&quot;label&quot;&gt;Min Temp&lt;/div&gt;&lt;div class=&quot;value&quot;&gt;${data.minTemp}°C&lt;/div&gt;&lt;/div&gt;&#10;                    &lt;div class=&quot;report-item&quot;&gt;&lt;div class=&quot;label&quot;&gt;Max Temp&lt;/div&gt;&lt;div class=&quot;value&quot;&gt;${data.maxTemp}°C&lt;/div&gt;&lt;/div&gt;&#10;                &lt;/div&gt;&#10;                &lt;div style=&quot;margin-top:20px;padding:20px;background:#f7fafc;border-radius:12px;font-size:14px;line-height:1.6&quot;&gt;&#10;                    ${data.summary}&#10;                &lt;/div&gt;&#10;            `;&#10;            result.classList.remove('hidden');&#10;        } catch (error) {&#10;            showToast('Failed to generate report', 'error');&#10;        } finally {&#10;            loading.classList.add('hidden');&#10;        }&#10;    }&#10;&#10;    // HISTORICAL&#10;    async function getHistoricalWeather() {&#10;        const city = document.getElementById('xmlrpcCity').value.trim();&#10;        if (!city) {&#10;            showToast('Enter a city', 'error');&#10;            return;&#10;        }&#10;        const loading = document.getElementById('xmlrpcLoading');&#10;        const result = document.getElementById('xmlrpcResult');&#10;        loading.classList.remove('hidden');&#10;        result.classList.add('hidden');&#10;        try {&#10;            const response = await fetch(`${XMLRPC_API}?city=${city}&amp;days=5`);&#10;            const data = await response.json();&#10;            if (Array.isArray(data) &amp;&amp; data.length &gt; 0) {&#10;                result.innerHTML = `&#10;                    &lt;table&gt;&#10;                        &lt;thead&gt;&lt;tr&gt;&lt;th&gt;Date/Time&lt;/th&gt;&lt;th&gt;Temp&lt;/th&gt;&lt;th&gt;Description&lt;/th&gt;&lt;th&gt;Humidity&lt;/th&gt;&lt;/tr&gt;&lt;/thead&gt;&#10;                        &lt;tbody&gt;&#10;                            ${data.map(day =&gt; `&#10;                                &lt;tr&gt;&#10;                                    &lt;td&gt;${day.timestamp ? new Date(day.timestamp).toLocaleString('pl-PL') : 'N/A'}&lt;/td&gt;&#10;                                    &lt;td&gt;${day.temperature ? day.temperature.toFixed(1) : 'N/A'}°C&lt;/td&gt;&#10;                                    &lt;td&gt;${day.description || 'N/A'}&lt;/td&gt;&#10;                                    &lt;td&gt;${day.humidity || 'N/A'}%&lt;/td&gt;&#10;                                &lt;/tr&gt;&#10;                            `).join('')}&#10;                        &lt;/tbody&gt;&#10;                    &lt;/table&gt;&#10;                `;&#10;            } else {&#10;                result.innerHTML = '&lt;div class=&quot;empty-state&quot;&gt;No data. Check weather first!&lt;/div&gt;';&#10;            }&#10;            result.classList.remove('hidden');&#10;        } catch (error) {&#10;            showToast('Failed to get history', 'error');&#10;        } finally {&#10;            loading.classList.add('hidden');&#10;        }&#10;    }&#10;&#10;    function showToast(message, type = 'success') {&#10;        const toast = document.getElementById('toast');&#10;        toast.textContent = message;&#10;        toast.className = `toast ${type}`;&#10;        toast.style.display = 'block';&#10;        setTimeout(() =&gt; toast.style.display = 'none', 3000);&#10;    }&#10;&lt;/script&gt;&#10;&#10;&lt;!-- ============================================ --&gt;&#10;&lt;!-- NOWA SEKCJA XML-RPC                         --&gt;&#10;&lt;!-- Zamień całą sekcję &quot;Historical Data&quot; na tę!--&gt;&#10;&lt;!-- ============================================ --&gt;&#10;&#10;&lt;!-- XML-RPC Historical Data --&gt;&#10;&lt;div class=&quot;section&quot;&gt;&#10;    &lt;div class=&quot;section-title&quot;&gt; XML-RPC Historical Data&lt;/div&gt;&#10;    &lt;p style=&quot;color: #64748b; margin-bottom: 20px; font-size: 14px;&quot;&gt;&#10;        Apache XML-RPC protocol • Synchronous + Asynchronous (3-second delay) • Connected to real database&#10;    &lt;/p&gt;&#10;&#10;    &lt;div class=&quot;form-row&quot;&gt;&#10;        &lt;div class=&quot;form-group&quot;&gt;&#10;            &lt;label&gt;City Name&lt;/label&gt;&#10;            &lt;input type=&quot;text&quot; id=&quot;xmlrpcCityNew&quot; placeholder=&quot;Warsaw&quot; value=&quot;Warsaw&quot;&gt;&#10;        &lt;/div&gt;&#10;        &lt;div class=&quot;form-group&quot;&gt;&#10;            &lt;label&gt;Number of Days&lt;/label&gt;&#10;            &lt;input type=&quot;number&quot; id=&quot;xmlrpcDaysNew&quot; placeholder=&quot;5&quot; value=&quot;5&quot; min=&quot;1&quot; max=&quot;10&quot;&gt;&#10;        &lt;/div&gt;&#10;    &lt;/div&gt;&#10;&#10;    &lt;div style=&quot;display: flex; gap: 12px; flex-wrap: wrap; margin-bottom: 20px;&quot;&gt;&#10;        &lt;button class=&quot;btn-primary&quot; onclick=&quot;getXmlRpcHistoryNew()&quot;&gt;&#10;            ⚡ Get History (Sync)&#10;        &lt;/button&gt;&#10;        &lt;button class=&quot;btn-success&quot; onclick=&quot;getXmlRpcHistoryAsyncNew()&quot;&gt;&#10;            ⏱️ Get History (Async 3s)&#10;        &lt;/button&gt;&#10;        &lt;button style=&quot;padding: 14px 28px; font-size: 16px; font-weight: 600; border: none; border-radius: 10px; cursor: pointer; background: linear-gradient(135deg, #06b6d4 0%, #0891b2 100%); color: white;&quot;&#10;                onclick=&quot;getXmlRpcStatisticsNew()&quot;&gt;&#10;             Get Statistics&#10;        &lt;/button&gt;&#10;    &lt;/div&gt;&#10;&#10;    &lt;div id=&quot;xmlrpcStatusNew&quot; class=&quot;loading hidden&quot;&gt;&lt;/div&gt;&#10;    &lt;div id=&quot;xmlrpcResultNew&quot; class=&quot;hidden&quot;&gt;&lt;/div&gt;&#10;&lt;/div&gt;&#10;&#10;&lt;script&gt;&#10;    // ============================================&#10;    // XML-RPC Functions - POPRAWIONE!&#10;    // ============================================&#10;&#10;    async function getXmlRpcHistoryNew() {&#10;        const city = document.getElementById('xmlrpcCityNew').value.trim();&#10;        const days = document.getElementById('xmlrpcDaysNew').value;&#10;&#10;        if (!city) {&#10;            showToast('Enter a city name', 'error');&#10;            return;&#10;        }&#10;&#10;        const statusDiv = document.getElementById('xmlrpcStatusNew');&#10;        const resultDiv = document.getElementById('xmlrpcResultNew');&#10;&#10;        statusDiv.textContent = '⏳ Calling XML-RPC Server (synchronous)...';&#10;        statusDiv.classList.remove('hidden');&#10;        resultDiv.classList.add('hidden');&#10;&#10;        try {&#10;            const response = await fetch(`http://localhost:8085/api/xmlrpc-proxy/history/${city}?days=${days}`);&#10;            const data = await response.json();&#10;&#10;            statusDiv.classList.add('hidden');&#10;            displayXmlRpcHistoryNew(data, false);&#10;            showToast('✅ XML-RPC sync call completed!');&#10;&#10;        } catch (error) {&#10;            statusDiv.classList.add('hidden');&#10;            showToast('Failed to call XML-RPC: ' + error.message, 'error');&#10;        }&#10;    }&#10;&#10;    async function getXmlRpcHistoryAsyncNew() {&#10;        const city = document.getElementById('xmlrpcCityNew').value.trim();&#10;        const days = document.getElementById('xmlrpcDaysNew').value;&#10;&#10;        if (!city) {&#10;            showToast('Enter a city name', 'error');&#10;            return;&#10;        }&#10;&#10;        const statusDiv = document.getElementById('xmlrpcStatusNew');&#10;        const resultDiv = document.getElementById('xmlrpcResultNew');&#10;&#10;        statusDiv.textContent = '⏳ Calling XML-RPC Server (async with 3-second delay)... Please wait...';&#10;        statusDiv.classList.remove('hidden');&#10;        resultDiv.classList.add('hidden');&#10;&#10;        const startTime = Date.now();&#10;&#10;        try {&#10;            const response = await fetch(`http://localhost:8085/api/xmlrpc-proxy/history-async/${city}?days=${days}`);&#10;            const data = await response.json();&#10;&#10;            const elapsed = ((Date.now() - startTime) / 1000).toFixed(1);&#10;&#10;            statusDiv.classList.add('hidden');&#10;            displayXmlRpcHistoryNew(data, true, elapsed);&#10;            showToast(`✅ XML-RPC async completed! (${elapsed}s with 3s server delay)`);&#10;&#10;        } catch (error) {&#10;            statusDiv.classList.add('hidden');&#10;            showToast('Failed to call XML-RPC: ' + error.message, 'error');&#10;        }&#10;    }&#10;&#10;    async function getXmlRpcStatisticsNew() {&#10;        const city = document.getElementById('xmlrpcCityNew').value.trim();&#10;&#10;        if (!city) {&#10;            showToast('Enter a city name', 'error');&#10;            return;&#10;        }&#10;&#10;        const statusDiv = document.getElementById('xmlrpcStatusNew');&#10;        const resultDiv = document.getElementById('xmlrpcResultNew');&#10;&#10;        statusDiv.textContent = '⏳ Getting statistics via XML-RPC...';&#10;        statusDiv.classList.remove('hidden');&#10;        resultDiv.classList.add('hidden');&#10;&#10;        try {&#10;            const response = await fetch(`http://localhost:8085/api/xmlrpc-proxy/statistics/${city}`);&#10;            const data = await response.json();&#10;&#10;            statusDiv.classList.add('hidden');&#10;            displayXmlRpcStatisticsNew(data);&#10;            showToast('✅ Statistics retrieved via XML-RPC!');&#10;&#10;        } catch (error) {&#10;            statusDiv.classList.add('hidden');&#10;            showToast('Failed to get statistics: ' + error.message, 'error');&#10;        }&#10;    }&#10;&#10;    function displayXmlRpcHistoryNew(data, isAsync, elapsed) {&#10;        const resultDiv = document.getElementById('xmlrpcResultNew');&#10;&#10;        if (!Array.isArray(data) || data.length === 0) {&#10;            resultDiv.innerHTML = '&lt;div class=&quot;empty-state&quot;&gt;No historical data available. Check weather first!&lt;/div&gt;';&#10;            resultDiv.classList.remove('hidden');&#10;            return;&#10;        }&#10;&#10;        // Check if first record has error&#10;        if (data[0].error) {&#10;            resultDiv.innerHTML = `&#10;                &lt;div style=&quot;padding: 20px; background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%); border-radius: 12px; color: white; text-align: center;&quot;&gt;&#10;                    &lt;div style=&quot;font-size: 18px; font-weight: 600; margin-bottom: 8px;&quot;&gt;&#10;                        ⚠️ No Historical Data&#10;                    &lt;/div&gt;&#10;                    &lt;div style=&quot;font-size: 14px;&quot;&gt;&#10;                        ${data[0].error}&#10;                    &lt;/div&gt;&#10;                    &lt;div style=&quot;margin-top: 12px; font-size: 13px; opacity: 0.9;&quot;&gt;&#10;                         Tip: First get current weather for ${data[0].city} to generate history!&#10;                    &lt;/div&gt;&#10;                &lt;/div&gt;&#10;            `;&#10;            resultDiv.classList.remove('hidden');&#10;            return;&#10;        }&#10;&#10;        let html = `&#10;        &lt;div style=&quot;padding: 20px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 12px; color: white; margin-bottom: 20px;&quot;&gt;&#10;            &lt;div style=&quot;font-size: 18px; font-weight: 600; margin-bottom: 8px;&quot;&gt;&#10;                ${isAsync ? '⏱️ Asynchronous Call' : '⚡ Synchronous Call'}&#10;            &lt;/div&gt;&#10;            &lt;div style=&quot;font-size: 14px; opacity: 0.9;&quot;&gt;&#10;                Retrieved ${data.length} records from Weather Provider via XML-RPC protocol&#10;                ${isAsync ? ` • Completed in ${elapsed}s (includes 3s server delay)` : ''}&#10;            &lt;/div&gt;&#10;        &lt;/div&gt;&#10;        &lt;table&gt;&#10;            &lt;thead&gt;&#10;                &lt;tr&gt;&#10;                    &lt;th&gt;#&lt;/th&gt;&#10;                    &lt;th&gt;City&lt;/th&gt;&#10;                    &lt;th&gt;Temperature&lt;/th&gt;&#10;                    &lt;th&gt;Description&lt;/th&gt;&#10;                    &lt;th&gt;Timestamp&lt;/th&gt;&#10;                &lt;/tr&gt;&#10;            &lt;/thead&gt;&#10;            &lt;tbody&gt;&#10;    `;&#10;&#10;        data.forEach((record, index) =&gt; {&#10;            html += `&#10;            &lt;tr&gt;&#10;                &lt;td&gt;${index + 1}&lt;/td&gt;&#10;                &lt;td&gt;${record.city || 'Unknown'}&lt;/td&gt;&#10;                &lt;td style=&quot;font-weight: 700; color: #3b82f6;&quot;&gt;${record.temperature ? record.temperature.toFixed(1) : 'N/A'}°C&lt;/td&gt;&#10;                &lt;td&gt;${record.description || 'N/A'}&lt;/td&gt;&#10;                &lt;td style=&quot;color: #64748b; font-size: 14px;&quot;&gt;${record.timestamp || record.date || 'N/A'}&lt;/td&gt;&#10;            &lt;/tr&gt;&#10;        `;&#10;        });&#10;&#10;        html += `&#10;            &lt;/tbody&gt;&#10;        &lt;/table&gt;&#10;    `;&#10;&#10;        resultDiv.innerHTML = html;&#10;        resultDiv.classList.remove('hidden');&#10;    }&#10;&#10;    function displayXmlRpcStatisticsNew(data) {&#10;        const resultDiv = document.getElementById('xmlrpcResultNew');&#10;&#10;        if (data.error) {&#10;            resultDiv.innerHTML = `&lt;div class=&quot;empty-state&quot;&gt;⚠️ ${data.error}&lt;/div&gt;`;&#10;            resultDiv.classList.remove('hidden');&#10;            return;&#10;        }&#10;&#10;        resultDiv.innerHTML = `&#10;        &lt;div class=&quot;report-grid&quot;&gt;&#10;            &lt;div class=&quot;report-item&quot;&gt;&#10;                &lt;div class=&quot;label&quot;&gt;City&lt;/div&gt;&#10;                &lt;div class=&quot;value&quot;&gt;${data.city || 'Unknown'}&lt;/div&gt;&#10;            &lt;/div&gt;&#10;            &lt;div class=&quot;report-item&quot;&gt;&#10;                &lt;div class=&quot;label&quot;&gt;Average Temp&lt;/div&gt;&#10;                &lt;div class=&quot;value&quot;&gt;${data.avgTemp || data.averageTemperature || 'N/A'}°C&lt;/div&gt;&#10;            &lt;/div&gt;&#10;            &lt;div class=&quot;report-item&quot;&gt;&#10;                &lt;div class=&quot;label&quot;&gt;Min Temp&lt;/div&gt;&#10;                &lt;div class=&quot;value&quot;&gt;${data.minTemp || data.minTemperature || 'N/A'}°C&lt;/div&gt;&#10;            &lt;/div&gt;&#10;            &lt;div class=&quot;report-item&quot;&gt;&#10;                &lt;div class=&quot;label&quot;&gt;Max Temp&lt;/div&gt;&#10;                &lt;div class=&quot;value&quot;&gt;${data.maxTemp || data.maxTemperature || 'N/A'}°C&lt;/div&gt;&#10;            &lt;/div&gt;&#10;            &lt;div class=&quot;report-item&quot;&gt;&#10;                &lt;div class=&quot;label&quot;&gt;Records&lt;/div&gt;&#10;                &lt;div class=&quot;value&quot;&gt;${data.recordCount || data.count || 'N/A'}&lt;/div&gt;&#10;            &lt;/div&gt;&#10;        &lt;/div&gt;&#10;    `;&#10;&#10;        resultDiv.classList.remove('hidden');&#10;    }&#10;&lt;/script&gt;&#10;&lt;/body&gt;&#10;&lt;/html&gt;" />
            </PendingDiffInfo>
          </value>
        </entry>
      </map>
    </option>
  </component>
</project>