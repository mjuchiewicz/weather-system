<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Weather System - Microservices Demo</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1>üå¶Ô∏è Weather System</h1>
            <p>Microservices Architecture Demo | gRPC ‚Ä¢ SOAP ‚Ä¢ REST ‚Ä¢ XML-RPC ‚Ä¢ RabbitMQ ‚Ä¢ Spring Cloud</p>
        </div>

        <!-- Weather Check (gRPC) -->
        <div class="section">
            <div class="section-title">üå§Ô∏è Weather Check (gRPC)</div>
            <p style="color: #64748b; margin-bottom: 20px; font-size: 14px;">
                Real-time weather data via gRPC protocol ‚Ä¢ Connected to OpenWeatherMap API
            </p>

            <div class="form-group">
                <label>City Name</label>
                <input type="text" id="city" placeholder="Enter city name (e.g., Warsaw, London)" value="Warsaw">
            </div>

            <button class="btn-primary" onclick="getWeather()">Check Weather</button>

            <div id="loading" class="loading">Fetching weather data...</div>
            <div id="result" class="hidden" style="margin-top: 24px;"></div>
        </div>

        <!-- Live Weather Stream (gRPC Server Streaming + SSE) -->
        <div class="section">
            <div class="section-title">üì° Live Weather Stream (gRPC + SSE)</div>
            <p style="color: #64748b; margin-bottom: 20px; font-size: 14px;">
                Real-time weather updates via gRPC server streaming ‚Ä¢ Multiple onNext() calls ‚Ä¢ Live data from OpenWeatherMap
            </p>

            <div class="form-row">
                <div class="form-group">
                    <label>City Name</label>
                    <input type="text" id="streamCity" placeholder="Warsaw" value="Warsaw">
                </div>
                <div class="form-group">
                    <label>Number of Updates</label>
                    <input type="number" id="streamUpdates" placeholder="10" value="10" min="1" max="20">
                </div>
                <div class="form-group">
                    <label>Interval (seconds)</label>
                    <input type="number" id="streamInterval" placeholder="5" value="5" min="2" max="10">
                </div>
            </div>

            <button class="btn-success" onclick="startWeatherStream()" id="streamButton">
                Start Live Stream
            </button>

            <div id="streamStatus" style="margin-top: 20px; padding: 16px; border-radius: 8px; display: none;"></div>
            <div id="streamResult" class="hidden" style="margin-top: 24px;"></div>
        </div>

        <!-- Alert Rules CRUD (REST + HATEOAS + RabbitMQ) -->
        <div class="section">
            <div class="section-title">‚ö†Ô∏è Alert Rules (REST + HATEOAS + RabbitMQ)</div>
            <p style="color: #64748b; margin-bottom: 20px; font-size: 14px;">
                CRUD operations with HATEOAS links ‚Ä¢ Alerts sent via RabbitMQ message queue
            </p>

            <form id="alertForm" onsubmit="addAlert(event)">
                <div class="form-row">
                    <div class="form-group">
                        <label>Alert Type</label>
                        <select id="alertType">
                            <option value="TEMPERATURE">Temperature</option>
                            <option value="HUMIDITY">Humidity</option>
                            <option value="PRESSURE">Pressure</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Operator</label>
                        <select id="operator">
                            <option value=">">Greater than (>)</option>
                            <option value="<">Less than (<)</option>
                            <option value=">=">Greater or equal (>=)</option>
                            <option value="<=">Less or equal (<=)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Threshold</label>
                        <input type="number" id="threshold" placeholder="20" step="0.1" required>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label>Severity</label>
                        <select id="severity">
                            <option value="LOW">Low</option>
                            <option value="MEDIUM">Medium</option>
                            <option value="HIGH">High</option>
                            <option value="EXTREME">Extreme</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Color</label>
                        <input type="color" id="color" value="#667eea">
                    </div>
                    <div class="form-group">
                        <label>Message</label>
                        <input type="text" id="message" placeholder="Temperature alert!" required>
                    </div>
                </div>

                <button type="submit" class="btn-primary">Add Alert Rule</button>
            </form>

            <table style="margin-top: 32px;">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Type</th>
                        <th>Condition</th>
                        <th>Severity</th>
                        <th>Color</th>
                        <th>Message</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody id="alertsTable">
                    <tr><td colspan="7" class="empty-state">Loading alerts...</td></tr>
                </tbody>
            </table>
        </div>

        <!-- SOAP Weather Report -->
        <div class="section">
            <div class="section-title">üìä Weather Report (SOAP)</div>
            <p style="color: #64748b; margin-bottom: 20px; font-size: 14px;">
                SOAP Web Service ‚Ä¢ WSDL/XSD schema ‚Ä¢ Statistical weather report with Feign Client
            </p>

            <div class="form-row">
                <div class="form-group">
                    <label>City Name</label>
                    <input type="text" id="reportCity" placeholder="Warsaw" value="Warsaw">
                </div>
                <div class="form-group">
                    <label>Number of Days</label>
                    <input type="number" id="reportDays" placeholder="7" value="7" min="1" max="30">
                </div>
            </div>

            <button class="btn-success" onclick="generateReport()">Generate SOAP Report</button>

            <div id="reportLoading" class="loading hidden">Generating report via SOAP...</div>
            <div id="reportResult" class="hidden" style="margin-top: 24px;"></div>
        </div>

        <!-- Advanced Statistics Service (Spring Cloud Feign) -->
        <div class="section">
            <div class="section-title">üìà Advanced Statistics Service</div>
            <p style="color: #64748b; margin-bottom: 20px; font-size: 14px;">
                Spring Cloud Feign Client ‚Ä¢ Advanced Analytics ‚Ä¢ Median, Std Dev, Trend Analysis, Outlier Detection
            </p>

            <div class="form-group">
                <label>City Name</label>
                <input type="text" id="statsCity" placeholder="Warsaw" value="Warsaw">
            </div>

            <button class="btn-success" onclick="getAdvancedStatistics()">Get Advanced Statistics</button>

            <div id="statsLoading" class="loading hidden">Calculating statistics...</div>
            <div id="statsResult" class="hidden" style="margin-top: 24px;"></div>
        </div>

        <!-- XML-RPC Historical Data -->
        <div class="section">
            <div class="section-title">üìã XML-RPC Historical Data</div>
            <p style="color: #64748b; margin-bottom: 20px; font-size: 14px;">
                Apache XML-RPC protocol ‚Ä¢ Synchronous + Asynchronous (3-second delay) ‚Ä¢ Connected to real database
            </p>

            <div class="form-row">
                <div class="form-group">
                    <label>City Name</label>
                    <input type="text" id="xmlrpcCityNew" placeholder="Warsaw" value="Warsaw">
                </div>
                <div class="form-group">
                    <label>Number of Days</label>
                    <input type="number" id="xmlrpcDaysNew" placeholder="5" value="5" min="1" max="30">
                </div>
            </div>

            <div style="display: flex; gap: 12px; margin-top: 20px;">
                <button class="btn-primary" onclick="getXmlRpcHistoryNew()">Get History (Sync)</button>
                <button class="btn-warning" onclick="getXmlRpcHistoryAsyncNew()">Get History (Async 3s)</button>
                <button class="btn-success" onclick="getXmlRpcStatisticsNew()">Get Statistics</button>
            </div>

            <div id="xmlrpcLoadingNew" class="loading hidden">Fetching data via XML-RPC...</div>
            <div id="xmlrpcResultNew" class="hidden" style="margin-top: 24px;"></div>
        </div>

    </div>

    <!-- Edit Alert Modal -->
    <div id="editModal" class="modal">
        <div class="modal-content">
            <h2 class="modal-title">Edit Alert Rule</h2>
            <form onsubmit="saveEdit(event)">
                <input type="hidden" id="editId">

                <div class="form-group">
                    <label>Alert Type</label>
                    <select id="editAlertType">
                        <option value="TEMPERATURE">Temperature</option>
                        <option value="HUMIDITY">Humidity</option>
                        <option value="PRESSURE">Pressure</option>
                    </select>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label>Operator</label>
                        <select id="editOperator">
                            <option value=">">></option>
                            <option value="<"><</option>
                            <option value=">=">>=</option>
                            <option value="<="><=</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Threshold</label>
                        <input type="number" id="editThreshold" step="0.1" required>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label>Severity</label>
                        <select id="editSeverity">
                            <option value="LOW">Low</option>
                            <option value="MEDIUM">Medium</option>
                            <option value="HIGH">High</option>
                            <option value="EXTREME">Extreme</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Color</label>
                        <input type="color" id="editColor">
                    </div>
                </div>

                <div class="form-group">
                    <label>Message</label>
                    <input type="text" id="editMessage" required>
                </div>

                <div class="modal-actions">
                    <button type="button" class="btn-danger" onclick="closeEditModal()">Cancel</button>
                    <button type="submit" class="btn-success">Save Changes</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Toast Notification -->
    <div id="toast" class="toast"></div>

    <!-- JavaScript -->
    <script src="app.js"></script>
</body>
</html>

